
<!DOCTYPE html>


<html lang="en" data-content_root="../" data-theme="light">

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>User’s Guide to CGNS &#8212; CGNS Documentation</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "light";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  <!--
    this give us a css class that will be invisible only if js is disabled
  -->
  <noscript>
    <style>
      .pst-js-only { display: none !important; }

    </style>
  </noscript>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=8878045cc6db502f8baf" rel="stylesheet" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=03e43079" />
    <link rel="stylesheet" type="text/css" href="../_static/styles/sphinx-book-theme.css?v=a3416100" />
    <link rel="stylesheet" type="text/css" href="../_static/graphviz.css?v=4ae1632d" />
    <link rel="stylesheet" type="text/css" href="../_static/css/custom.css?v=6bab4044" />
    <link rel="stylesheet" type="text/css" href="../_static/css/filemap.css?v=2c72f61b" />
  
  <!-- So that users can add custom icons -->
  <script src="../_static/scripts/fontawesome.js?digest=8878045cc6db502f8baf"></script>
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf" />

    <script src="../_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="../_static/doctools.js?v=9bcbadda"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'doc/userguide';</script>
    <link rel="canonical" href="https://cgns.org/doc/userguide.html" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="CGNS Governance" href="../governance.html" />
    <link rel="prev" title="Papers" href="papers.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  <meta name="docsearch:version" content="" />
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="light">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Skip to main content</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Back to top</button>

  
  <dialog id="pst-search-dialog">
    
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         placeholder="Search..."
         aria-label="Search..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
  </dialog>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Version warning"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <dialog id="pst-primary-sidebar-modal"></dialog>
      <div id="pst-primary-sidebar" class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
  
    
    
    
    <img src="../_static/CGNS_logo_nobckgrnd.svg" class="logo__image only-light" alt="CGNS Documentation - Home"/>
    <img src="../_static/CGNS_logo_nobckgrnd.svg" class="logo__image only-dark pst-js-only" alt="CGNS Documentation - Home"/>
  
  
</a></div>
        <div class="sidebar-primary-item"><ul class="navbar-icon-links"
    aria-label="Icon Links">
        <li class="nav-item">
          
          
          
          
          
          
          
          
          <a href="https://github.com/CGNS/CGNS" title="GitHub" class="nav-link pst-navbar-icon" rel="noopener" target="_blank" data-bs-toggle="tooltip" data-bs-placement="bottom"><i class="fa-solid fa-download fa-lg" aria-hidden="true"></i>
            <span class="sr-only">GitHub</span></a>
        </li>
</ul></div>
        <div class="sidebar-primary-item">

<button class="btn search-button-field search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
 <i class="fa-solid fa-magnifying-glass"></i>
 <span class="search-button__default-text">Search</span>
 <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
</button></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../general.html">Introduction to CGNS</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../general/what.html">What is CGNS?</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/start.html">Quick Start Guide</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/overview.html">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/history.html">Status and History</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/glossary.html">Glossary</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/FAQ.html">FAQ</a></li>
<li class="toctree-l2"><a class="reference internal" href="../general/implementations.html">Implementations</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../standard.html">Standard Specification</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../standard/reference.html">Standardization bodies</a></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../standard/SIDS/CGNS_SIDS.html">CGNS/SIDS - Standard Interface Data Structures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/intro.html">1. Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/design.html">2. Design Philosophy of Standard Interface Data Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/convention.html">3. Conventions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/block.html">4. Building Block Structure Definition</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/array.html">5. Data-Array Structure Definitions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/hierarchy.html">6. Hierarchical Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/grid.html">7. Grid Coordinates, Elements, and Flow Solution</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/multizone.html">8. Multizone Interface Connectivity</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/boundary.html">9. Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/equation.html">10. Governing Flow Equations</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/time.html">11. Time-Dependent Flow</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/misc.html">12. Miscellaneous Data Structures</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/particles.html">13. Particle Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/appendix_a.html">Appendix A: Conventions for Data-Name Identifiers</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/SIDS/appendix_b.html">Appendix B: Structured Two-Zone Flat Plate Example</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../standard/CGNS_FMM.html">CGNS/FMM - Data model mapping to implementation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../standard/FMM/nodes.html">Detailed CGNS Node Descriptions</a></li>
<li class="toctree-l3 has-children"><a class="reference internal" href="../standard/FMM/figures.html">CGNS File Mapping Figures</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ArbitraryGridMotion.html">ArbitraryGridMotion Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/Area.html">Area Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/AverageInterface.html">AverageInterface Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/Axisymmetry.html">Axisymmetry Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/BaseIterativeData.html">BaseIterativeData Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/BC.html">BC Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/BCData.html">BCData Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/BCDataSet.html">BCDataSet Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/BCProperty.html">BCProperty Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/CGNSBase.html">CGNSBase Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ChemicalKineticsModel.html">ChemicalKineticsModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ConvergenceHistory.html">ConvergenceHistory Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/DataArray.html">DataArray Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/DimensionalExponents.html">DimensionalExponents Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/DimensionalUnits.html">DimensionalUnits Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/Elements.html">Elements Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/EMConductivityModel.html">EMConductivityModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/EMElectricFieldModel.html">EMElectricFieldModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/EMMagneticFieldModel.html">EMMagneticFieldModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/Family.html">Family Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/FamilyBC.html">FamilyBC Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/FamilyBCDataSet.html">FamilyBCDataSet Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/FlowEquationSet.html">FlowEquationSet Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/FlowSolution.html">FlowSolution/DiscreteData Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/GasModel.html">GasModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/GeometryReference.html">GeometryReference Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/GoverningEquations.html">GoverningEquations Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/Gravity.html">Gravity Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/GridConnectivity.html">GridConnectivity Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/GridConnectivity1to1.html">GridConnectivity1to1 Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/GridConnectivityProperty.html">GridConnectivityProperty Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/GridCoordinates.html">GridCoordinates Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/IntegralData.html">IntegralData Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/OversetHoles.html">OversetHoles Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleBreakupModel.html">ParticleBreakupModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleCollisionModel.html">ParticleCollisionModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleCoordinates.html">ParticleCoordinates Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleEquationSet.html">ParticleEquationSet Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleForceModel.html">ParticleForceModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleGoverningEquations.html">ParticleGoverningEquations Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticlePhaseChangeModel.html">ParticlePhaseChangeModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleSolution.html">ParticleSolution Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleWallInteractionModel.html">ParticleWallInteractionModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ParticleZone.html">ParticleZone Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/Periodic.html">Periodic Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ReferenceState.html">ReferenceState Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/RigidGridMotion.html">RigidGridMotion Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/RotatingCoordinates.html">RotatingCoordinates Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ThermalConductivityModel.html">ThermalConductivityModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ThermalRelaxationModel.html">ThermalRelaxationModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/TurbulenceClosure.html">TurbulenceClosure Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/TurbulenceModel.html">TurbulenceModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/UserDefinedData.html">UserDefinedData Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ViscosityModel.html">ViscosityModel Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/WallFunction.html">WallFunction Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/Zone.html">Zone Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ZoneBC.html">ZoneBC Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ZoneGridConnectivity.html">ZoneGridConnectivity Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ZoneIterativeData.html">ZoneIterativeData/ParticleIterativeData Figure</a></li>
<li class="toctree-l4"><a class="reference internal" href="../standard/FMM/ZoneSubRegion.html">ZoneSubRegion Figure</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../standard/MLL/CGNS_MLL.html">CGNS/MLL - C and Fortran APIs for Applications</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3 has-children"><a class="reference internal" href="../standard/MLL/api/general_remarks.html">General Remarks</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l4"><a class="reference internal" href="../standard/MLL/api/enums.html">List of enumerated values (key words) for each of these variable types (typedefs)</a></li>
</ul>
</details></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/MLL/api/c_api.html">CGNS/MLL API Overview for C and Fortran applications</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/MLL/api/c_parallel_api.html">CGNS Parallel API Overview</a></li>
</ul>
</details></li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../standard/CGNS_CGIO.html">CGNS/CGIO - Basic node implementation</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_database.html">Database-Level Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_structure.html">Data Structure Management Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_links.html">Link Management Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_node.html">Node Management Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_dataio.html">Data I/O Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_errors.html">Error Handling Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_misc.html">Miscellaneous Routines</a></li>
<li class="toctree-l3"><a class="reference internal" href="../standard/CGIO/CGNS_CGIO_example.html">Code Examples</a></li>
</ul>
</details></li>
<li class="toctree-l2"><a class="reference internal" href="../standard/hdf5.html">CGNS/HDF5 - An HPC implementation</a></li>
<li class="toctree-l2"><a class="reference internal" href="../standard/python.html">CGNS/Python - A Python implementation</a></li>
</ul>
</details></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="../current.html">Resources</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../current/news.html">News</a></li>

<li class="toctree-l2"><a class="reference internal" href="../current/CPEX.html">CPEX</a></li>
<li class="toctree-l2"><a class="reference internal" href="../current/download.html">Download</a></li>
<li class="toctree-l2"><a class="reference internal" href="../current/examples.html">Examples</a></li>
<li class="toctree-l2"><a class="reference internal" href="../current/softwarelist.html">More CGNS Software</a></li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="../doc.html">More documentation</a><details open="open"><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="papers.html">Papers</a></li>

<li class="toctree-l3 current active"><a class="current reference internal" href="#">User’s Guide to CGNS</a></li>
</ul>
</details></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../governance.html">CGNS Governance</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../governance/committee.html">Steering Committee</a></li>
<li class="toctree-l2"><a class="reference internal" href="../governance/meetings.html">Meetings</a></li>
<li class="toctree-l2"><a class="reference internal" href="../governance/support.html">Support</a></li>
</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
      <div class="sidebar-primary-item">
<div id="ethical-ad-placement"
      class="flat"
      data-ea-publisher="readthedocs"
      data-ea-type="readthedocs-sidebar"
      data-ea-manual="true">
</div></div>
  </div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/CGNS/cgns-modern.github.io" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/CGNS/cgns-modern.github.io/issues/new?title=Issue%20on%20page%20%2Fdoc/userguide.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button pst-js-only" aria-label="Color mode" data-bs-title="Color mode"  data-bs-placement="bottom" data-bs-toggle="tooltip">
  <i class="theme-switch fa-solid fa-sun                fa-lg" data-mode="light" title="Light"></i>
  <i class="theme-switch fa-solid fa-moon               fa-lg" data-mode="dark"  title="Dark"></i>
  <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"  title="System Settings"></i>
</button>


<button class="btn btn-sm pst-navbar-icon search-button search-button__button pst-js-only" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
</button>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>User’s Guide to CGNS</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structured-grid">Structured grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-structured-grid">Single-zone structured grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-structured-grid-and-flow-solution">Single-Zone Structured Grid and Flow Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-flow-solution-at-vertices">(a) Flow Solution at Vertices</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b-flow-solution-at-cell-centers">(b) Flow Solution at Cell Centers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#c-flow-solution-at-cell-centers-with-additional-rind-data">(c) Flow Solution at Cell Centers With Additional Rind Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-structured-grid-with-boundary-conditions">Single-Zone Structured Grid with Boundary Conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-boundary-conditions-specifying-range">(a) Boundary Conditions Specifying Range</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b-boundary-conditions-specifying-points">(b) Boundary Conditions Specifying Points</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-zone-structured-grid-with-1-to-1-connectivity">Multi-Zone Structured Grid with 1-to-1 Connectivity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-connectivity-using-specific-1-to-1-method">(a) Connectivity Using Specific 1-to-1 Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b-connectivity-using-general-method">(b) Connectivity Using General Method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unstructured-grid">Unstructured Grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-unstructured-grid">Single-Zone Unstructured Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-unstructured-grid-and-flow-solution">Single-Zone Unstructured Grid and Flow Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-unstructured-grid-with-boundary-conditions">Single-Zone Unstructured Grid with Boundary Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-information">Additional Information</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence-history">Convergence History</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptor-nodes">Descriptor Nodes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensional-data">Dimensional Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nondimensional-data">Nondimensional Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-equation-sets">Flow Equation Sets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-data">Time-Dependent Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-links">Using Links</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#troubleshooting">Troubleshooting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-errors">Handling Errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#known-problems">Known Problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-computer-codes">Example Computer Codes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Structured Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Unstructured Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general">General</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section id="user-s-guide-to-cgns">
<span id="docuserguide"></span><h1>User’s Guide to CGNS<a class="headerlink" href="#user-s-guide-to-cgns" title="Link to this heading">#</a></h1>
<p>A concise introduction to many of the most commonly used features of CGNS, with coding examples using the Mid-Level Library to write and read simple files containing CGNS databases.</p>
<p>This User Guide is intended as a tutorial: light in content but heavy on examples, advice, and guidelines.
The original version of this User’s Guide was also published in NASA/TM-2001-211236, October 2001.</p>
<p>All examples of source code discussed in this Guide are available from <a class="reference external" href="https://github.com/CGNS/CGNS/tree/master/src/Test_UserGuideCode">github repository</a> , as a complement to the document itself.
We strongly recommend that you download these examples.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Questions and comments on this guide are welcome and should be directed to
the CGNS forum <a class="reference external" href="https://github.com/CGNS/CGNS/discussions/categories/cgnstalk">CGNStalk</a>.</p>
</div>
<p>The rules and conventions governing how the nodes in a CGNS file are organized, including their names and labels, are specified in the SIDS document, with additional details in the SIDS File Mapping Manual. These documents also specify in detail how CFD information will be stored within the nodes in a standardized fashion so that other users can easily access and read it. When a CGNS file strictly adheres to the rules given in the SIDS document, it is said to be “SIDS-compliant.” A CGNS file must be SIDS-compliant in order for other users to be able to interpret it correctly.
A brief overview of the most commonly used aspects of the SIDS is included in the current document.</p>
<p>However, the user does not need to fully understand the SIDS document to get started with CGNS.
The mid-level API calls have been created to aid users in writing and reading SIDS-compliant CGNS files.
[There are currently two levels of programming access to CGNS. The lowest level consists of CGIO-level calls interacting directly with the database manager. These calls perform the most basic functions, such as creating a child node, writing data, reading data, etc. However, these low-level calls know nothing about the SIDS, so the user is responsible for putting data in the correct place to make the CGNS file SIDS-compliant. The mid-level, or API calls, which always begin with the characters “<cite>cg_</cite>”, were written with knowledge of the SIDS. Therefore, it is easier to adhere to the SIDS standards when writing a CGNS file using the API calls, and some checks for SIDS-compliance are also made by the API calls when accessing a CGNS file (SIDS compliance is not guaranteed, but the API calls go a long way toward facilitating it). The API calls also drastically shorten the calling sequences necessary to perform many of the functions needed to create and read CGNS files.] Using the API, most CFD data of interest to the majority of users can be written into or read from a CGNS file very easily with only an elementary understanding of the SIDS.</p>
<p>In the following sections, we give detailed instructions on creating typical CGNS files or portions of files.
These instructions are given in the form of simple examples.
They make use of the mid-level API calls, although not all API calls are covered in this document (a complete list of available API calls can be found in the Mid-Level Library document).
We recommend that the user read through the examples in this section in order because some information in the later sections depends on being familiar with the information given in the earlier ones.
Hopefully, users can easily extend these simple examples to their applications.
Additional applications are covered in a later section.</p>
<p>Also, note that we have delayed the discussion of units and nondimensionalization until later.
For now, all examples simply store and retrieve pure numbers, and it is assumed that the user knows the dimensions or nondimensionalizations of each variable.</p>
<section id="structured-grid">
<h2>Structured grid<a class="headerlink" href="#structured-grid" title="Link to this heading">#</a></h2>
<p>This first section gives several structured grid examples, whereas the following section gives unstructured grid examples. However, we recommend that the current section be read first, in its entirety, even if the user is only interested in unstructured grid applications. This is because much of the organization of the CGNS files is identical for both grid types, and later sections of this document assume that the user is familiar with the information given in earlier sections.</p>
<section id="single-zone-structured-grid">
<h3>Single-zone structured grid<a class="headerlink" href="#single-zone-structured-grid" title="Link to this heading">#</a></h3>
<p>This first example is for a straightforward 3-D Cartesian grid of size 21 × 17 × 9. The grid points themselves are created using the following FORTRAN code snippet:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nk</span>
<span class="w">   </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nj</span>
<span class="w">      </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ni</span>
<span class="w">         </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">         </span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">         </span><span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="k">   enddo</span>
<span class="k">enddo</span>
</pre></div>
</div>
<p>where <cite>ni=21</cite>, <cite>nj=17</cite>, and <cite>nk=9</cite>. A picture of the grid is shown below.</p>
<figure class="align-center" id="id3">
<a class="reference internal image-reference" href="../_images/grid_cartesian.gif"><img alt="Cartesian Grid" src="../_images/grid_cartesian.gif" style="width: 146px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Simple Cartesian structured grid.</em></span><a class="headerlink" href="#id3" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>A complete FORTRAN code that creates this grid and uses API calls to write it to a CGNS file called grid.cgns is shown here (note that a FORTRAN line continuation is denoted by a +).
This (and all later) coded examples are available from the CGNS site external link, and summarized in this document in the section Example Computer Codes.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="k">program </span><span class="n">write_grid_str</span>
<span class="c">!</span>
<span class="c">!   Creates simple 3-D structured grid and writes it to a</span>
<span class="c">!   CGNS file.</span>
<span class="c">!</span>
<span class="c">!   This program uses the fortran convention that all</span>
<span class="c">!   variables beginning with the letters i-n are integers,</span>
<span class="c">!   by default, and all others are real</span>
<span class="c">!</span>
<span class="c">!   Example compilation for this program is (change paths!):</span>
<span class="c">!</span>
<span class="c">!   ifort -I ../CGNS_CVS/cgnslib -c write_grid_str.f</span>
<span class="c">!   ifort -o write_grid_str write_grid_str.o -L ../CGNS_CVS/cgnslib/LINUX -lcgns</span>
<span class="c">!</span>
<span class="c">!   (../CGNS_CVS/cgnslib/LINUX/ is the location where the compiled</span>
<span class="c">!   library libcgns.a is located)</span>
<span class="c">!</span>
<span class="c">!   cgns.mod and cgnstypes_f03.h files must be located in the directory specified by -I during compilation:</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="w">      </span><span class="k">implicit none</span>
<span class="cp">#include &quot;cgnstypes_f03.h&quot;</span>
<span class="c">!</span>
<span class="c">!   dimension statements (note that tri-dimensional arrays</span>
<span class="c">!   x,y,z must be dimensioned exactly as (21,17,N) (N&gt;=9)</span>
<span class="c">!   for this particular case, or else they will be written to</span>
<span class="c">!   the CGNS file incorrectly!  Other options are to use 1-D</span>
<span class="c">!   arrays, use dynamic memory, or pass index values to a</span>
<span class="c">!   subroutine and dimension exactly there):</span>
<span class="w">      </span><span class="kt">real</span><span class="o">*</span><span class="mi">8</span><span class="w"> </span><span class="n">x</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="n">y</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">),</span><span class="n">z</span><span class="p">(</span><span class="mi">21</span><span class="p">,</span><span class="mi">17</span><span class="p">,</span><span class="mi">9</span><span class="p">)</span>
<span class="w">      </span><span class="k">dimension </span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span>
<span class="w">      </span><span class="kt">character </span><span class="n">basename</span><span class="o">*</span><span class="mi">32</span><span class="p">,</span><span class="n">zonename</span><span class="o">*</span><span class="mi">32</span>
<span class="c">!</span>
<span class="c">!   create gridpoints for simple example:</span>
<span class="w">      </span><span class="n">ni</span><span class="o">=</span><span class="mi">21</span>
<span class="w">      </span><span class="n">nj</span><span class="o">=</span><span class="mi">17</span>
<span class="w">      </span><span class="n">nk</span><span class="o">=</span><span class="mi">9</span>
<span class="w">      </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nk</span>
<span class="w">        </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nj</span>
<span class="w">          </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ni</span>
<span class="w">            </span><span class="n">x</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">y</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">            </span><span class="n">z</span><span class="p">(</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">)</span><span class="o">=</span><span class="nb">float</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="k">enddo</span>
<span class="k">        enddo</span>
<span class="k">      enddo</span>
<span class="k">      write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39; created simple 3-D grid points&#39;&#39;)&#39;</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!   WRITE X, Y, Z GRID POINTS TO CGNS FILE</span>
<span class="c">!   open CGNS file for write</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_WRITE</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   create base (user can give any name)</span>
<span class="w">      </span><span class="n">basename</span><span class="o">=</span><span class="s1">&#39;Base&#39;</span>
<span class="w">      </span><span class="n">icelldim</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="n">iphysdim</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_base_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">basename</span><span class="p">,</span><span class="n">icelldim</span><span class="p">,</span><span class="n">iphysdim</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   define zone name (user can give any name)</span>
<span class="w">      </span><span class="n">zonename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zone  1&#39;</span>
<span class="c">!   vertex size</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">21</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">17</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">9</span>
<span class="c">!   cell size</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span>
<span class="c">!   boundary vertex size (always zero for structured grids)</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="c">!   create zone</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_zone_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">zonename</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">Structured</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   write grid coordinates (user must use SIDS-standard names here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateX&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">index_coord</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateY&#39;</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">index_coord</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateZ&#39;</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">index_coord</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39; Successfully wrote grid to file grid.cgns&#39;&#39;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">stop</span>
<span class="k">      end</span>
</pre></div>
</div>
<p>There are several items to note regarding this code. An integer index is returned whenever a new entity is created using the API. This index is used in subsequent API calls to refer to the entity. For example, the above call to cg_open_f opens the file grid.cgns and assigns to this entity the index index_file. This same index_file is used to identify this entity in subsequent calls. Similarly, cg_base_write_f assigns an index index_base to the base, cg_zone_write_f assigns an index index_zone to the zone, and cg_coord_write_f assigns an index index_coord to each coordinate.</p>
<p>For FORTRAN code, an include statement pointing to cgnslib_f.h must be present. (The cgnslib_f.h file comes with the CGNS software.) Also, it is imperative that the x, y, and z arrays be dimensioned exactly as (21,17,N), where N ≥ 9 (or else as a one-dimensional array of at least size 21*17*9) for this particular example; this is because the cg_coord_write_f routine writes the first 21*17*9 values contained in the array as it is stored in memory. If x, y, and z are tri-dimensional arrays and the first two indices are dimensioned larger than 21 and 17, respectively, then incorrect values will be placed in the CGNS file. In a real working code, one would probably either (a) use one-dimensional arrays, (b) dynamically allocate appropriate memory for x, y, and z, or else (c) pass the index values to a subroutine and write via an appropriately dimensioned work array.</p>
<p>In this case, the cell dimension (icelldim) is 3 (because the grid is made up of volume cells), and the physical dimension (iphysdim) is 3 (because 3 coordinates define 3-D). (See the section Overview of the SIDS for a more detailed description.) The isize array contains the vertex size, cell size, and boundary vertex size for each index direction. For a 3-D structured grid, the index dimension is always the same as the cell dimension, so this means there are 3 vertex sizes, 3 cell sizes, and 3 boundary vertex sizes (one each for the i, j, and k directions). For structured grids, the cell size is always one less than the corresponding vertex size, and the boundary vertex size has no meaning and is always zero. When writing the grid coordinates, the user must use SIDS-standard names. For example, coordinates of x, y, and z must be named CoordinateX, CoordinateY, and CoordinateZ, respectively. Other standard names exist for other possible choices. Finally, basename and zonename must be declared as character strings, and the integer array isize must be dimensioned appropriately.</p>
<p>The grid coordinate arrays can be written in single or double precision. The desired data type is communicated to the API using the keywords RealSingle or RealDouble. The user must ensure that the data type transmitted to the API is consistent with the the one used in declaring the coordinates arrays. When it is compiled, the code must also link to the compiled CGNS library libcgns.a. Instructions for compiling the CGNS library are given in README files that come with the CGNS software.</p>
<p>Here is complete code written in C that performs the same task of creating grid coordinates and writing them to a CGNS file.</p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="cm">/*   Program write_grid_str.c    */</span>
<span class="cm">/*</span>
<span class="cm">Creates simple 3-D structured grid and writes it to a</span>
<span class="cm">CGNS file.</span>

<span class="cm">Example compilation for this program is (change paths!):</span>

<span class="cm">cc -I ../CGNS_CVS/cgnslib -c write_grid_str.c</span>
<span class="cm">cc -o write_grid_str_c write_grid_str.o -L ../CGNS_CVS/cgnslib/LINUX -lcgns</span>

<span class="cm">(../CGNS_CVS/cgnslib/LINUX/ is the location where the compiled</span>
<span class="cm">library libcgns.a is located)</span>
<span class="cm">*/</span>

<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;string.h&gt;</span>
<span class="cm">/* cgnslib.h file must be located in directory specified by -I during compile: */</span>
<span class="cp">#include</span><span class="w"> </span><span class="cpf">&quot;cgnslib.h&quot;</span>

<span class="cp">#if CG_BUILD_SCOPE</span>
<span class="cp">#  error enumeration scoping needs to be off</span>
<span class="cp">#endif</span>

<span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">()</span>
<span class="p">{</span>
<span class="cm">/*</span>
<span class="cm">   dimension statements (note that tri-dimensional arrays</span>
<span class="cm">   x,y,z must be dimensioned exactly as [N][17][21] (N&gt;=9)</span>
<span class="cm">   for this particular case or else they will be written to</span>
<span class="cm">   the CGNS file incorrectly!  Other options are to use 1-D</span>
<span class="cm">   arrays, use dynamic memory, or pass index values to a</span>
<span class="cm">   subroutine and dimension exactly there):</span>
<span class="cm">*/</span>
<span class="w">   </span><span class="kt">double</span><span class="w"> </span><span class="n">x</span><span class="p">[</span><span class="mi">9</span><span class="p">][</span><span class="mi">17</span><span class="p">][</span><span class="mi">21</span><span class="p">],</span><span class="n">y</span><span class="p">[</span><span class="mi">9</span><span class="p">][</span><span class="mi">17</span><span class="p">][</span><span class="mi">21</span><span class="p">],</span><span class="n">z</span><span class="p">[</span><span class="mi">9</span><span class="p">][</span><span class="mi">17</span><span class="p">][</span><span class="mi">21</span><span class="p">];</span>
<span class="w">   </span><span class="n">cgsize_t</span><span class="w"> </span><span class="n">isize</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">3</span><span class="p">];</span>
<span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">ni</span><span class="p">,</span><span class="n">nj</span><span class="p">,</span><span class="n">nk</span><span class="p">,</span><span class="n">i</span><span class="p">,</span><span class="n">j</span><span class="p">,</span><span class="n">k</span><span class="p">;</span>
<span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">index_file</span><span class="p">,</span><span class="n">icelldim</span><span class="p">,</span><span class="n">iphysdim</span><span class="p">,</span><span class="n">index_base</span><span class="p">;</span>
<span class="w">   </span><span class="kt">int</span><span class="w"> </span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_coord</span><span class="p">;</span>
<span class="w">   </span><span class="kt">char</span><span class="w"> </span><span class="n">basename</span><span class="p">[</span><span class="mi">33</span><span class="p">],</span><span class="n">zonename</span><span class="p">[</span><span class="mi">33</span><span class="p">];</span>

<span class="cm">/* create gridpoints for simple example: */</span>
<span class="w">   </span><span class="n">ni</span><span class="o">=</span><span class="mi">21</span><span class="p">;</span>
<span class="w">   </span><span class="n">nj</span><span class="o">=</span><span class="mi">17</span><span class="p">;</span>
<span class="w">   </span><span class="n">nk</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span>
<span class="w">   </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">k</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">k</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nk</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">k</span><span class="p">)</span>
<span class="w">   </span><span class="p">{</span>
<span class="w">     </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">j</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">j</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">nj</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">j</span><span class="p">)</span>
<span class="w">     </span><span class="p">{</span>
<span class="w">       </span><span class="k">for</span><span class="w"> </span><span class="p">(</span><span class="n">i</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span><span class="w"> </span><span class="n">i</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="n">ni</span><span class="p">;</span><span class="w"> </span><span class="o">++</span><span class="n">i</span><span class="p">)</span>
<span class="w">       </span><span class="p">{</span>
<span class="w">         </span><span class="n">x</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">i</span><span class="p">;</span>
<span class="w">         </span><span class="n">y</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">j</span><span class="p">;</span>
<span class="w">         </span><span class="n">z</span><span class="p">[</span><span class="n">k</span><span class="p">][</span><span class="n">j</span><span class="p">][</span><span class="n">i</span><span class="p">]</span><span class="o">=</span><span class="n">k</span><span class="p">;</span>
<span class="w">       </span><span class="p">}</span>
<span class="w">     </span><span class="p">}</span>
<span class="w">   </span><span class="p">}</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">created simple 3-D grid points&quot;</span><span class="p">);</span>

<span class="cm">/* WRITE X, Y, Z GRID POINTS TO CGNS FILE */</span>
<span class="cm">/* open CGNS file for write */</span>
<span class="w">   </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">cg_open</span><span class="p">(</span><span class="s">&quot;grid_c.cgns&quot;</span><span class="p">,</span><span class="n">CG_MODE_WRITE</span><span class="p">,</span><span class="o">&amp;</span><span class="n">index_file</span><span class="p">))</span><span class="w"> </span><span class="n">cg_error_exit</span><span class="p">();</span>
<span class="cm">/* create base (user can give any name) */</span>
<span class="w">   </span><span class="n">strcpy</span><span class="p">(</span><span class="n">basename</span><span class="p">,</span><span class="s">&quot;Base&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="n">icelldim</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
<span class="w">   </span><span class="n">iphysdim</span><span class="o">=</span><span class="mi">3</span><span class="p">;</span>
<span class="w">   </span><span class="n">cg_base_write</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">basename</span><span class="p">,</span><span class="n">icelldim</span><span class="p">,</span><span class="n">iphysdim</span><span class="p">,</span><span class="o">&amp;</span><span class="n">index_base</span><span class="p">);</span>
<span class="cm">/* define zone name (user can give any name) */</span>
<span class="w">   </span><span class="n">strcpy</span><span class="p">(</span><span class="n">zonename</span><span class="p">,</span><span class="s">&quot;Zone  1&quot;</span><span class="p">);</span>
<span class="cm">/* vertex size */</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">21</span><span class="p">;</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">17</span><span class="p">;</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">9</span><span class="p">;</span>
<span class="cm">/* cell size */</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="n">isize</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="mi">-1</span><span class="p">;</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="n">isize</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="mi">-1</span><span class="p">;</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="n">isize</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="mi">-1</span><span class="p">;</span>
<span class="cm">/* boundary vertex size (always zero for structured grids) */</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="w">   </span><span class="n">isize</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span><span class="p">;</span>
<span class="cm">/* create zone */</span>
<span class="w">   </span><span class="n">cg_zone_write</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">zonename</span><span class="p">,</span><span class="o">*</span><span class="n">isize</span><span class="p">,</span><span class="n">Structured</span><span class="p">,</span><span class="o">&amp;</span><span class="n">index_zone</span><span class="p">);</span>
<span class="cm">/* write grid coordinates (user must use SIDS-standard names here) */</span>
<span class="w">   </span><span class="n">cg_coord_write</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="s">&quot;CoordinateX&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="n">x</span><span class="p">,</span><span class="o">&amp;</span><span class="n">index_coord</span><span class="p">);</span>
<span class="w">   </span><span class="n">cg_coord_write</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="s">&quot;CoordinateY&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="n">y</span><span class="p">,</span><span class="o">&amp;</span><span class="n">index_coord</span><span class="p">);</span>
<span class="w">   </span><span class="n">cg_coord_write</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="s">&quot;CoordinateZ&quot;</span><span class="p">,</span>
<span class="w">       </span><span class="n">z</span><span class="p">,</span><span class="o">&amp;</span><span class="n">index_coord</span><span class="p">);</span>
<span class="cm">/* close CGNS file */</span>
<span class="w">   </span><span class="n">cg_close</span><span class="p">(</span><span class="n">index_file</span><span class="p">);</span>
<span class="w">   </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;</span><span class="se">\n</span><span class="s">Successfully wrote grid to file grid_c.cgns</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span>
<span class="w">   </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The “.h” file, which is called <cite>cgnslib.h</cite>, must be included in the C code.</p>
</div>
<p>From now on, all codes will be given in FORTRAN only. The C-equivalent calls are similar, as demonstrated above.
Also, to save space, complete code will not be shown from now on, but rather only code segments.
However, complete codes can be accessed from the CGNS site external link.</p>
<p>The CGNS file grid.cgns created by the code above is a binary file that internally possesses the tree-like structure shown below. Each tree node has a name and a label and may or may not contain data.
In the figure’s example, all the nodes contain data except for the GridCoordinates node, for which MT indicates no data.</p>
<figure class="align-center" id="id4">
<a class="reference internal image-reference" href="../_images/tree_cartesian.gif"><img alt="Cartesian Grid Layout" src="../_images/tree_cartesian.gif" style="width: 240px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of CGNS file for simple Cartesian structured grid.</em></span><a class="headerlink" href="#id4" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>However, in this case, the user does not need to know the full details of the tree-like structure.
The API has automatically created a SIDS-compliant CGNS file!
Now, the user can just as easily read the CGNS file using the API.
The FORTRAN code segment used to read the CGNS file grid.cgns that we just created is given here:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   READ X, Y, Z GRID POINTS FROM CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="w">      </span><span class="k">implicit none</span>
<span class="c">!   open CGNS file for read-only</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_READ</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   get zone size (and name - although not needed here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_zone_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">zonename</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">isize</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   lower range index</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   upper range index of vertices</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!   read grid coordinates</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateX&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">irmin</span><span class="p">,</span><span class="n">irmax</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateY&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">irmin</span><span class="p">,</span><span class="n">irmax</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateZ&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">irmin</span><span class="p">,</span><span class="n">irmax</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this FORTRAN coding is very rudimentary. It assumes that we know that there is only one base and one zone. In a real working code, one should check the numbers in the file and either allow for the possibility of multiple bases or zones or explicitly disallow it. Also, this coding implicitly assumes that the grid.cgns file is a 3-D structured grid (cell dimension = physical dimension = 3). In a real working code, one should check to ensure this is true or allow for other possibilities. One should also check to ensure the zone type is <em>Structured</em> and if this is the expected type.</p>
<p>As before, the x, y, and z arrays in this case <em>must</em> be dimensioned correctly: for a tri-dimensional array, (21,17,N), where N ≥ 9. (In an actual working code, one would probably either (a) use one-dimensional arrays, (b) dynamically allocate appropriate memory for x, y, and z after reading <em>isize</em>, or else (c) pass the isize values to a subroutine and dimension a work array appropriately prior to reading.) Also note that, regardless of the precision in which the grid coordinates were written to the CGNS file (single or double), one can read them either way; the API automatically performs the translation. (The arrays x, y, and z in the code above must be declared as single precision if RealSingle is used and as double precision if RealDouble is used.) Finally, <em>isize</em> should be dimensioned appropriately, <em>zonename</em> should be declared as a character variable, and <em>irmin</em> and <em>irmax</em> should be dimensioned appropriately.</p>
</section>
<section id="single-zone-structured-grid-and-flow-solution">
<h3>Single-Zone Structured Grid and Flow Solution<a class="headerlink" href="#single-zone-structured-grid-and-flow-solution" title="Link to this heading">#</a></h3>
<p>In this section, we now write a flow solution associated with the grid from the previous section. We assume we have two flow solution arrays available: static density and static pressure. To illustrate three important options, we will show how to write the flow solution (a) at vertices, (b) at cell centers, and (c) at cell centers plus rind cells.</p>
<section id="a-flow-solution-at-vertices">
<h4>(a) Flow Solution at Vertices<a class="headerlink" href="#a-flow-solution-at-vertices" title="Link to this heading">#</a></h4>
<p>The first option is illustrated schematically in 2-D in the figure below. Simply stated, a Vertex flow solution is located at the same location as the grid points. Assuming that the grid points have already been written to a CGNS file, the following FORTRAN code segment adds the flow solution at vertices:</p>
<figure class="align-center" id="id5">
<a class="reference internal image-reference" href="../_images/vertex.gif"><img alt="Vertex solution" src="../_images/vertex.gif" style="width: 250px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Schematic showing location (circles) of Vertex flow solution relative to grid.</em></span><a class="headerlink" href="#id5" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE FLOW SOLUTION TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   define flow solution node name (user can give any name)</span>
<span class="w">      </span><span class="n">solname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution&#39;</span>
<span class="c">!   create flow solution node</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_sol_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">solname</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">Vertex</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   write flow solution (user must use SIDS-standard names here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In this code, the density (r) and pressure (p) variables must be dimensioned correctly for this particular case: for a tri-dimensional array, (21,17,N), where N ≥ 9 (see discussion in the previous section). Note that the API, knowing that the flow solution type is Vertex, automatically writes out the correct index range, corresponding with the zone’s grid index range. Also, note that we opened the existing CGNS file and modified it (CG_MODE_MODIFY) - we knew ahead of time that only one base and only one zone exist; an actual working code would make appropriate checks. Finally, solname should be declared as a character variable and r and p must be declared as double precision variables when RealDouble type is used.</p>
</div>
<p>The layout of the CGNS file with the flow solution at vertices included is shown in the figure below. The three nodes under GridCoordinates_t have been left out to conserve space in the figure, but they exist as indicated by the three unconnected lines.</p>
<figure class="align-center" id="id6">
<a class="reference internal image-reference" href="../_images/tree_cartesian_solV.gif"><img alt="Cartesian Grid with Solution layout" src="../_images/tree_cartesian_solV.gif" style="width: 240px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of CGNS file for simple Cartesian structured grid with flow solution at vertices.</em></span><a class="headerlink" href="#id6" title="Link to this image">#</a></p>
</figcaption>
</figure>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Because GridLocation = Vertex is the default, it is not necessary to specify it.</p>
</div>
<p>The vertex flow solution can be read using the following FORTRAN code segment (can read in as single or double precision - see discussion in the previous section):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   READ FLOW SOLUTION FROM CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for read-only</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_READ</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one FlowSolution_t (real working code would check!)</span>
<span class="w">      </span><span class="n">index_flow</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   get zone size (and name - although not needed here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_zone_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">zonename</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">isize</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   lower range index</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   upper range index - use vertex dimensions</span>
<span class="c">!   checking GridLocation first (real working code would check</span>
<span class="c">!   to make sure there are no Rind cells also!):</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_sol_info_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">solname</span><span class="p">,</span><span class="nb">loc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">loc</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">Vertex</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39; Error, GridLocation must be Vertex!&#39;&#39;)&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">stop</span>
<span class="k">      end if</span>
<span class="k">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!   read flow solution</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">irmin</span><span class="p">,</span><span class="n">irmax</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">irmin</span><span class="p">,</span><span class="n">irmax</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This code segment assumes that it is known that the flow solution contains no rind data (to be covered in detail below). If rind data exists but the user does not account for it, then the flow solution information will be misread. Hence, an actual working code would check for rind cells, and adjust the dimensions and index ranges appropriately. Other cautions similar to those mentioned earlier regarding the dimensioning of variables, real working code checks, etc., apply here as well. These cautions will only sometimes be repeated from this point forward.</p>
</div>
</section>
<section id="b-flow-solution-at-cell-centers">
<h4>(b) Flow Solution at Cell Centers<a class="headerlink" href="#b-flow-solution-at-cell-centers" title="Link to this heading">#</a></h4>
<p>The figure below illustrates schematically the option for outputting the flow solution at cell centers in 2-D. The flow solutions are defined at the centers of the cells by the four surrounding grid points. In 3-D, the cell centers are defined by eight surrounding grid points.</p>
<figure class="align-center" id="id7">
<a class="reference internal image-reference" href="../_images/cellcenter.gif"><img alt="Cell center solution" src="../_images/cellcenter.gif" style="width: 200px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Schematic showing location (circles) of CellCenter flow solution relative to grid.</em></span><a class="headerlink" href="#id7" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The code segment to write to cell centers is identical to that given above for vertices, except that the call to cg_sol_write_f is replaced by:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   create flow solution node (NOTE USE OF CellCenter HERE)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_sol_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">solname</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">CellCenter</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Also, now the density (r) and pressure (p) variables must be dimensioned correctly for this particular case: for a tri-dimensional array, (20,16,N), where N ≥ 8 (i.e., one less in each index dimension than the grid itself). Again, knowing that the flow solution type is CellCenter, the API automatically writes out the correct index range, corresponding with the zone’s grid index range minus 1 in each index direction.</p>
<p>The next figure shows the layout of the CGNS file with the flow solution at cell centers (below the FlowSolution_t node only). Note that the indices over which the flow solutions are written are now from (1,1,1) to (20,16,8) (contrast with the FlowSolution part of the figure with the flow solution at vertices</p>
<figure class="align-center" id="id8">
<a class="reference internal image-reference" href="../_images/tree_cartesian_solC.gif"><img alt="cell center solution tree layout" src="../_images/tree_cartesian_solC.gif" style="width: 250px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>layout of cgns file (under flowsolution_t node) for simple cartesian structured grid with flow solution at cell centers.</em></span><a class="headerlink" href="#id8" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The FORTRAN code segment to read in the solution at cell centers is the same as that given above for vertices, except that the section that defines irmax is replaced by:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   upper range index - use cell dimensions</span>
<span class="c">!   checking GridLocation first (real working code would check</span>
<span class="c">!   to make sure there are no Rind cells also!):</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_sol_info_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">solname</span><span class="p">,</span><span class="nb">loc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">loc</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CellCenter</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39; Error, GridLocation must be CellCenter!&#39;&#39;)&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">stop</span>
<span class="k">      end if</span>
<span class="k">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<p>and, as usual, the r and p arrays must be dimensioned appropriately.</p>
</section>
<section id="c-flow-solution-at-cell-centers-with-additional-rind-data">
<h4>(c) Flow Solution at Cell Centers With Additional Rind Data<a class="headerlink" href="#c-flow-solution-at-cell-centers-with-additional-rind-data" title="Link to this heading">#</a></h4>
<p>Rind data is additional flow solution data exterior to a grid, at “ghost” locations. Rind data can be associated with other GridLocation values besides CellCenter, although we only show an example using CellCenter here. Furthermore, this example is for structured grids only, for which Rind data can be defined implicitly (via indexing conventions alone). The option for outputting the flow solution at cell centers with additional rind data is illustrated schematically in 2-D in the figure below. This diagram shows one layer of rind cell data in the row below the grid itself. There could be rind data at other sides of the grid, or there could be more than one row at a given side.</p>
<figure class="align-center" id="id9">
<a class="reference internal image-reference" href="../_images/cellcenter_rind.gif"><img alt="4 by 3  grid with row of rind cells below, with circle at cell center" src="../_images/cellcenter_rind.gif" style="width: 170px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Schematic showing location (circles) of CellCenter flow solution, including rind cells, relative to grid.</em></span><a class="headerlink" href="#id9" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>In CGNS, the flow solution at rind cells is not stored as separate entities; rather, the flow solution range is extended to include the rind cells. For example, in the 2-D schematic of the above figure, instead of an index range of p(3,2) for pressures stored at the cell centers, the flow solution would now have an index range of p(3,0:2) or p(3,3). See the SIDS document for details.</p>
<p>For our 3-D example, we assume that we have one row of rind data at 4 faces of the zone (ilo, ihi, jlo, jhi, where these represent the low and high ends of the i and j directions, respectively), and no rind cells at klo or khi (at either end of the k direction). The code segment to write the flow solution and rind data is as follows:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE FLOW SOLUTION TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   define flow solution node name (user can give any name)</span>
<span class="w">      </span><span class="n">solname</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution&#39;</span>
<span class="c">!   create flow solution node (NOTE USE OF CellCenter HERE)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_sol_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">solname</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">CellCenter</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  go to position within tree at FlowSolution_t node</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowSolution_t&#39;</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   write rind information under FlowSolution_t node (ilo,ihi,jlo,jhi,klo,khi)</span>
<span class="w">      </span><span class="n">irinddata</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irinddata</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irinddata</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irinddata</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irinddata</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="n">irinddata</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_rind_write_f</span><span class="p">(</span><span class="n">irinddata</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   write flow solution (user must use SIDS-standard names here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that in the case of rind data, the user must position the Rind_t node appropriately using the cg_goto_f call. In this case, the Rind_t node belongs under the FlowSolution_t node.</p>
<p>For this case of cell center flow solution with rind data, the density (r) and pressure (p) are written to the CGNS file with the following index ranges: from i = 0 to i = 20 + 1 = 21 (or a total i length of 22), from j = 0 to j = 16 + 1 = 17 (or a total j length of 18), and from k = 1 to k = 8. The variables r and p must be dimensioned appropriately to reflect these index ranges modified by the rind values.</p>
<p>The layout of the CGNS file for this example (below the FlowSolution_t node only) is shown below. Compare this figure with the figures for the flow solution at vertices and for the flow solution at cell centers without rind data.</p>
<figure class="align-center" id="id10">
<a class="reference internal image-reference" href="../_images/tree_cartesian_solCR.gif"><img alt="Diagram showing CGNS layout for flow solution at cell centers, and rind data" src="../_images/tree_cartesian_solCR.gif" style="width: 420px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of CGNS file (under FlowSolution_t node) for simple Cartesian structured grid with flow solution at cell centers plus rind data</em></span><a class="headerlink" href="#id10" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>A FORTRAN code segment to read the flow solution for this example is:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   READ FLOW SOLUTION FROM CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for read-only</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_READ</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one FlowSolution_t (real working code would check!)</span>
<span class="w">      </span><span class="n">index_flow</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   get zone size (and name - although not needed here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_zone_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">zonename</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">isize</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  go to position within tree at FlowSolution\_t node</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowSolution_t&#39;</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!  read rind data</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_rind_read_f</span><span class="p">(</span><span class="n">irinddata</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   lower range index</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">irmin</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   upper range index - use cell dimensions and rind info</span>
<span class="c">!   checking GridLocation first:</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_sol_info_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">solname</span><span class="p">,</span><span class="nb">loc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="nb">loc</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CellCenter</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">        write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39; Error, GridLocation must be CellCenter!&#39;&#39;)&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">stop</span>
<span class="k">      end if</span>
<span class="k">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">irinddata</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">+</span><span class="n">irinddata</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">irinddata</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">+</span><span class="n">irinddata</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span>
<span class="w">      </span><span class="n">irmax</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">+</span><span class="n">irinddata</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">+</span><span class="n">irinddata</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span>
<span class="c">!   read flow solution</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">irmin</span><span class="p">,</span><span class="n">irmax</span><span class="p">,</span><span class="n">r</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_field_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">irmin</span><span class="p">,</span><span class="n">irmax</span><span class="p">,</span><span class="n">p</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="single-zone-structured-grid-with-boundary-conditions">
<h3>Single-Zone Structured Grid with Boundary Conditions<a class="headerlink" href="#single-zone-structured-grid-with-boundary-conditions" title="Link to this heading">#</a></h3>
<p>To illustrate the use of boundary conditions, we again use the same single-zone Cartesian grid. Referring back to the grid figure, we wish to apply the following:</p>
<blockquote>
<div><ul class="simple">
<li><p>ilo - BCTunnelInflow</p></li>
<li><p>ihi - BCExtrapolate</p></li>
<li><p>jlo - BCWallInviscid</p></li>
<li><p>jhi - etc.</p></li>
<li><p>klo - etc.</p></li>
<li><p>khi - etc.</p></li>
</ul>
</div></blockquote>
<p>where <cite>BCTunnelInflow</cite>, <cite>BCExtrapolate</cite>, and <cite>BCWallInviscid</cite> are data-name identifiers for boundary conditions. The complete list of boundary condition identifiers is found in the SIDS document. In this example, we take the approach of using the lowest-level BC implementation allowed - see the figure showing the general hierarchical structure of ZoneBC_t in the SIDS overview section.</p>
<p>In this section, we show two different approaches for defining the region over which each boundary condition acts. The first is with type <cite>PointRange</cite>, meaning that we define the minimum and maximum points on a face that define a logically rectangular region (this method is usable only for faces that are capable of being defined in this way). The second is with the type <cite>PointList</cite>, which lists all the points for which the boundary condition applies. This latter method is generally used for any zone whose defined region is not logically rectangular.</p>
<section id="a-boundary-conditions-specifying-range">
<h4>(a) Boundary Conditions Specifying Range<a class="headerlink" href="#a-boundary-conditions-specifying-range" title="Link to this heading">#</a></h4>
<p>A FORTRAN code segment to write the boundary condition information of type PointRange to the existing CGNS file from the previous two sections is given here:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE BOUNDARY CONDITIONS TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!  we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   get zone size (and name - although not needed here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_zone_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">zonename</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">isize</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="n">ilo</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">ihi</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">jlo</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">jhi</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="n">klo</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="n">khi</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!  write boundary conditions for ilo face, defining range first</span>
<span class="c">!  (user can give any name)</span>
<span class="c">!  lower point of range</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span>
<span class="c">!  upper point of range</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Ilo&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCTunnelInflow</span><span class="p">,</span><span class="n">PointRange</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  write boundary conditions for ihi face, defining range first</span>
<span class="c">!  (user can give any name)</span>
<span class="c">!  lower point of range</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span>
<span class="c">!  upper point of range</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Ihi&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCExtrapolate</span><span class="p">,</span><span class="n">PointRange</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  write boundary conditions for jlo face, defining range first</span>
<span class="c">!  (user can give any name)</span>
<span class="c">!  lower point of range</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span>
<span class="c">!  upper point of range</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Jlo&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCWallInviscid</span><span class="p">,</span><span class="n">PointRange</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="p">...</span><span class="w"> </span><span class="n">etc</span><span class="p">...</span>
<span class="c">!  close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>The zone names (e.g., Ilo) are arbitrary. Note that the variable <cite>zonename</cite> must be declared as a character variable, and <cite>isize</cite> and <cite>ipnt</cite> must be dimensioned appropriately.</p>
<p>The layout of the CGNS file for this example is shown below. Four of the children nodes of ZoneBC_t are left off for clarity.</p>
<figure class="align-center" id="id11">
<a class="reference internal image-reference" href="../_images/tree_cartesian_BC.gif"><img alt="Diagram showing CGNS layout with boundary conditions defined using PointRange" src="../_images/tree_cartesian_BC.gif" style="width: 420px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of CGNS file for simple Cartesian structured grid with flow solution and boundary conditions using PointRange.</em></span><a class="headerlink" href="#id11" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>Reading the boundary conditions can also be easily accomplished using API calls, but we do not show an example of this here. Because there are multiple BC_t children nodes under the ZoneBC_t node, the user must first read the number of children nodes that exist, then loop through them and retrieve the information from each.</p>
</section>
<section id="b-boundary-conditions-specifying-points">
<h4>(b) Boundary Conditions Specifying Points<a class="headerlink" href="#b-boundary-conditions-specifying-points" title="Link to this heading">#</a></h4>
<p>The FORTRAN code segment to write the boundary conditions using PointList is the same as that for PointRange except that the following segment, for example,</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  write boundary conditions for ilo face, defining range first</span>
<span class="c">!  (user can give any name)</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span>
<span class="w">      </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Ilo&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCTunnelInflow</span><span class="p">,</span><span class="n">PointRange</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>is replaced by</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  write boundary conditions for ilo face, defining pointlist first</span>
<span class="c">!  (user can give any name)</span>
<span class="w">      </span><span class="n">icount</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="n">jlo</span><span class="p">,</span><span class="n">jhi</span>
<span class="w">        </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">klo</span><span class="p">,</span><span class="n">khi</span>
<span class="w">          </span><span class="n">icount</span><span class="o">=</span><span class="n">icount</span><span class="o">+</span><span class="mi">1</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">j</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">k</span>
<span class="w">        </span><span class="k">enddo</span>
<span class="k">      enddo</span>
<span class="k">      call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Ilo&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCTunnelInflow</span><span class="p">,</span><span class="n">PointList</span><span class="p">,</span><span class="n">icount</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>The layout of the CGNS file in this case is the same as in the above figure, except that PointRange (IndexRange_t) becomes <cite>PointList</cite> (<cite>IndexArray_t</cite>) and there is <cite>icount</cite> data in the PointList nodes.</p>
</section>
</section>
<section id="multi-zone-structured-grid-with-1-to-1-connectivity">
<h3>Multi-Zone Structured Grid with 1-to-1 Connectivity<a class="headerlink" href="#multi-zone-structured-grid-with-1-to-1-connectivity" title="Link to this heading">#</a></h3>
<p>For the case of a multi-zone structured grid, each zone is handled individually in the same way as the examples in the preceding sections. However, multi-zone grids also require additional information about how the zones are connected to one another. A discussion of different types of zone-to-zone connectivity can be found in the SIDS overview section. For the example in this section, we show only a simple 1-to-1 connectivity example. We assume that we have a two-zone grid, each identical to the single zone used previously (21 × 17 × 9), except that zone 2 is offset in the x-direction by 20 units. Thus, the ilo face of zone 2 abuts the ihi face of zone 1, and each abutting point in the two zones touches a point from the neighboring zone. A picture of the grid is shown below.</p>
<figure class="align-center" id="id12">
<a class="reference internal image-reference" href="../_images/grid_cartesian2.gif"><img alt="Figure showing a two-zone Cartesian grid, with 1-to-1 connectivity" src="../_images/grid_cartesian2.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>2-Zone Cartesian structured grid with 1-to-1 connectivity.</em></span><a class="headerlink" href="#id12" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The overall layout of this two-zone CGNS file is not shown here. It is similar to those shown earlier, except now there are two zones rather than one. See the SIDS overview for an additional example.</p>
<p>Now, 1-to-1 connectivity information must be written into each of the zones. There are two ways to record this 1-to-1 information. The first (specific) method is valid only for 1-to-1 interfaces, and the regions must be logically rectangular (because they are recorded via PointRange and PointRangeDonor nodes, for which only two points define the entire region). The second way is more general. It uses PointList nodes in combination with PointListDonor. (A third method, used to describe interfaces that are not point-matched - such as mismatched or overset zones - employs CellListDonor and InterpolantsDonor.) Refer to the SIDS document for details on the various methods for describing connectivity.</p>
<section id="a-connectivity-using-specific-1-to-1-method">
<h4>(a) Connectivity Using Specific 1-to-1 Method<a class="headerlink" href="#a-connectivity-using-specific-1-to-1-method" title="Link to this heading">#</a></h4>
<p>The 1-to-1 connectivity information for the current example can be written to a CGNS file using the following FORTRAN code segment (assuming that all grid information has already been written):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE 1-TO-1 CONNECTIVITY INFORMATION TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   get number of zones (should be 2 for our case)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_nzones_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">nzone</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   loop over zones to get zone sizes and names</span>
<span class="w">      </span><span class="k">do </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nzone</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_zone_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="n">zonename</span><span class="p">(</span><span class="n">index_zone</span><span class="p">),</span><span class="n">isize</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="n">ilo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">        </span><span class="n">ihi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">jlo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">        </span><span class="n">jhi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">klo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">        </span><span class="n">khi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!   loop over zones again</span>
<span class="w">      </span><span class="k">do </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nzone</span>
<span class="c">!   set up index ranges</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">index_zone</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">donorname</span><span class="o">=</span><span class="n">zonename</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c">!   lower point of receiver range</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!   upper point of receiver range</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!   lower point of donor range</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c">!   upper point of donor range</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          </span><span class="n">donorname</span><span class="o">=</span><span class="n">zonename</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!   lower point of receiver range</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c">!   upper point of receiver range</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="c">!   lower point of donor range</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="c">!   upper point of donor range</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">jhi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">          </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="n">khi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="c">!   set up Transform</span>
<span class="w">        </span><span class="n">itranfrm</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">        </span><span class="n">itranfrm</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">2</span>
<span class="w">        </span><span class="n">itranfrm</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">3</span>
<span class="c">!   write 1-to-1 info (user can give any name)</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_1to1_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="s1">&#39;Interface&#39;</span><span class="p">,</span><span class="n">donorname</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">ipntsdonor</span><span class="p">,</span><span class="n">itranfrm</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="n">index_conn</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!  close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that this code segment is specifically geared toward our 2-zone example, i.e., it relies on our knowledge of this case. Transform defines the relative orientation of the i, j, and k indices of the abutting zones. Details concerning the values of Transform can be found in the SIDS document. However, note that Transform values of (1,2,3) indicate that the i, j, k axes of both zones are oriented in the same directions. Reading the connectivity information can also be easily accomplished using API calls, but we do not show an example of this here. And finally, we do not show the layout of the nodes associated with the connectivity here. The interested user is referred to the SIDS overview for an example figure.</p>
</section>
<section id="b-connectivity-using-general-method">
<h4>(b) Connectivity Using General Method<a class="headerlink" href="#b-connectivity-using-general-method" title="Link to this heading">#</a></h4>
<p>Using a more general method, for which each connectivity pair is listed (rather than ranges), the connectivity information for the current example can be written to a CGNS file using the following FORTRAN code segment:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE GENERAL CONNECTIVITY INFORMATION TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   get number of zones (should be 2 for our case)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_nzones_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">nzone</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   loop over zones to get zone sizes and names</span>
<span class="w">      </span><span class="k">do </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nzone</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_zone_read_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="n">zonename</span><span class="p">(</span><span class="n">index_zone</span><span class="p">),</span><span class="n">isize</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="n">ilo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">        </span><span class="n">ihi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">jlo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">        </span><span class="n">jhi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="n">klo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">        </span><span class="n">khi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span><span class="o">=</span><span class="n">isize</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!   loop over zones again</span>
<span class="w">      </span><span class="k">do </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nzone</span>
<span class="c">!   set up point lists</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">index_zone</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          </span><span class="n">icount</span><span class="o">=</span><span class="mi">0</span>
<span class="w">          </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">),</span><span class="n">jhi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">),</span><span class="n">khi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span>
<span class="w">              </span><span class="n">icount</span><span class="o">=</span><span class="n">icount</span><span class="o">+</span><span class="mi">1</span>
<span class="w">              </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">              </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">j</span>
<span class="w">              </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">k</span>
<span class="w">              </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">              </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">j</span>
<span class="w">              </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">k</span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">          enddo</span>
<span class="k">          </span><span class="n">donorname</span><span class="o">=</span><span class="n">zonename</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          </span><span class="n">icount</span><span class="o">=</span><span class="mi">0</span>
<span class="w">          </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="n">jlo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">),</span><span class="n">jhi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span>
<span class="w">            </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="n">klo</span><span class="p">(</span><span class="n">index_zone</span><span class="p">),</span><span class="n">khi</span><span class="p">(</span><span class="n">index_zone</span><span class="p">)</span>
<span class="w">              </span><span class="n">icount</span><span class="o">=</span><span class="n">icount</span><span class="o">+</span><span class="mi">1</span>
<span class="w">              </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">ilo</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="w">              </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">j</span>
<span class="w">              </span><span class="n">ipnts</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">k</span>
<span class="w">              </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">ihi</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">              </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">j</span>
<span class="w">              </span><span class="n">ipntsdonor</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">k</span>
<span class="w">            </span><span class="k">enddo</span>
<span class="k">          enddo</span>
<span class="k">          </span><span class="n">donorname</span><span class="o">=</span><span class="n">zonename</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="c">!   write integer connectivity info (user can give any name)</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_conn_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="s1">&#39;GenInterface&#39;</span><span class="p">,</span><span class="n">Vertex</span><span class="p">,</span><span class="n">Abutting1to1</span><span class="p">,</span><span class="n">PointList</span><span class="p">,</span><span class="n">icount</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="n">donorname</span><span class="p">,</span><span class="n">Structured</span><span class="p">,</span><span class="n">PointListDonor</span><span class="p">,</span><span class="kt">Integer</span><span class="p">,</span><span class="n">icount</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="n">ipntsdonor</span><span class="p">,</span><span class="n">index_conn</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!  close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>The method for recording mismatched (patched) or overset connectivity information is described in the SIDS document. However, note that in such cases the use of CellListDonor (along with InterpolantsDonor) implies the specification of cell center indices on the donor side (these would correspond to element numbers in unstructured zones). The InterpolantsDonor information consists of real-valued interpolants.</p>
</section>
</section>
</section>
<section id="unstructured-grid">
<h2>Unstructured Grid<a class="headerlink" href="#unstructured-grid" title="Link to this heading">#</a></h2>
<p>This section provides several unstructured grid examples. The user should already be familiar with the information covered in the previous section, which provides
structured grid examples. Because the organization of the CGNS files is identical for both grid types, many of the ideas covered in the structured grid section are not repeated here.</p>
<section id="single-zone-unstructured-grid">
<h3>Single-Zone Unstructured Grid<a class="headerlink" href="#single-zone-unstructured-grid" title="Link to this heading">#</a></h3>
<p>This example uses the exact single-zone grid shown earlier. However, it is now written as an unstructured grid comprising a series of 6-sided elements (cubes in this case). A FORTRAN code segment that uses API calls to write this grid to a CGNS file called <em>grid.cgns</em> is shown here (note that it does not matter how the nodes are ordered in an unstructured zone, but in this example, they are ordered sequentially for simplicity of presentation):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE X, Y, Z GRID POINTS TO CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for write</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_WRITE</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  create base (user can give any name)</span>
<span class="w">      </span><span class="n">basename</span><span class="o">=</span><span class="s1">&#39;Base&#39;</span>
<span class="w">      </span><span class="n">icelldim</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="n">iphysdim</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_base_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">basename</span><span class="p">,</span><span class="n">icelldim</span><span class="p">,</span><span class="n">iphysdim</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  define zone name (user can give any name)</span>
<span class="w">      </span><span class="n">zonename</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;Zone  1&#39;</span>
<span class="c">!  we use the same grid as for the structured example with ni=21,</span>
<span class="c">!  nj=17, nk=9.  The variables ni, nj, and nk are still used later,</span>
<span class="c">!  for convenience when numbering the unstructured grid elements.</span>
<span class="w">      </span><span class="n">ni</span><span class="o">=</span><span class="mi">21</span>
<span class="w">      </span><span class="n">nj</span><span class="o">=</span><span class="mi">17</span>
<span class="w">      </span><span class="n">nk</span><span class="o">=</span><span class="mi">9</span>
<span class="c">!  vertex size (21*17*9 = 3213)</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">3213</span>
<span class="c">!  cell size (20*16*8 = 2560)</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">2560</span>
<span class="c">!  boundary vertex size (zero if elements not sorted)</span>
<span class="w">      </span><span class="n">isize</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="c">!  create zone</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_zone_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">zonename</span><span class="p">,</span><span class="n">isize</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">Unstructured</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  write grid coordinates (user must use SIDS-standard names here)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateX&#39;</span><span class="p">,</span><span class="n">x</span><span class="p">,</span><span class="n">index_coord</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateY&#39;</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">index_coord</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_coord_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;CoordinateZ&#39;</span><span class="p">,</span><span class="n">z</span><span class="p">,</span><span class="n">index_coord</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  set element connectivity:</span>
<span class="c">!  do all the HEX_8 elements (this part is mandatory):</span>
<span class="c">!  maintain SIDS-standard ordering</span>
<span class="w">      </span><span class="n">ielem_no</span><span class="o">=</span><span class="mi">0</span>
<span class="c">!  index no of first element</span>
<span class="w">      </span><span class="n">nelem_start</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nk</span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nj</span><span class="o">-</span><span class="mi">1</span>
<span class="w">          </span><span class="k">do </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ni</span><span class="o">-</span><span class="mi">1</span>
<span class="w">            </span><span class="n">ielem_no</span><span class="o">=</span><span class="n">ielem_no</span><span class="o">+</span><span class="mi">1</span>
<span class="c">!  in this example, due to the order in the node numbering, the</span>
<span class="c">!  hexahedral elements can be reconstructed using the following</span>
<span class="c">!  relationships:</span>
<span class="w">            </span><span class="n">ifirstnode</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ni</span><span class="o">+</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="mi">1</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">ni</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span><span class="o">+</span><span class="mi">1</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">7</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span><span class="o">+</span><span class="mi">1</span><span class="o">+</span><span class="n">ni</span>
<span class="w">            </span><span class="n">ielem</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span><span class="o">+</span><span class="n">ni</span>
<span class="w">          </span><span class="k">enddo</span>
<span class="k">        enddo</span>
<span class="k">      enddo</span>
<span class="c">!  index no of last element (=2560)</span>
<span class="w">      </span><span class="n">nelem_end</span><span class="o">=</span><span class="n">ielem_no</span>
<span class="c">!  unsorted boundary elements</span>
<span class="w">      </span><span class="n">nbdyelem</span><span class="o">=</span><span class="mi">0</span>
<span class="c">!  write HEX_8 element connectivity (user can give any name)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_section_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;Elem&#39;</span><span class="p">,</span><span class="n">HEXA_8</span><span class="p">,</span><span class="n">nelem_start</span><span class="p">,</span><span class="n">nelem_end</span><span class="p">,</span><span class="n">nbdyelem</span><span class="p">,</span><span class="n">ielem</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">  </span><span class="n">index_section</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that for unstructured zones, the index dimension is always 1 (because only one index value is required to identify a position in the mesh), so the isize array contains the total vertex size, cell size, and boundary vertex size for the zone. In this example, the ielem array must be dimensioned exactly as (8,N), where N is greater than or equal to the total number of elements. The node points that lie in the lower left corner of the grid are shown schematically for two elements in the figure below. Here it can be seen, for example, that node numbers 1, 2, 23, 22, 358, 359, 380, and 379 make up element 1.</p>
<figure class="align-center" id="id13">
<a class="reference internal image-reference" href="../_images/grid_cartesianU.gif"><img alt="Figure showing two elements of the unstructured hexagonal grid" src="../_images/grid_cartesianU.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Schematic representation of nodes and elements of unstructured grid.</em></span><a class="headerlink" href="#id13" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The overall layout of the CGNS file created by the above code segment is shown below. The nodes for y and z are left off due to lack of space. Compare this figure with the layout for the structured version of this grid.</p>
<figure class="align-center" id="id14">
<a class="reference internal image-reference" href="../_images/tree_cartesianU.gif"><img alt="Diagram showing CGNS layout for unstructured grid" src="../_images/tree_cartesianU.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of CGNS file for unstructured grid.</em></span><a class="headerlink" href="#id14" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>For unstructured zones, the user may also wish to list the boundary elements in the CGNS file separately. This may be useful for assigning boundary conditions, as we will show later. In the current example, assume that the user wishes to assign three different types of boundary conditions: inflow at one end, outflow at the other end, and side walls on the four faces in-between. To accomplish this, it would be helpful to have three additional Elements_t nodes in the CGNS file, each of which lists the corresponding faces as elements (QUAD_4 in this case).</p>
<p>A FORTRAN code segment that accomplishes a part of this is given here. It may be a part of the same code (above) that defined the grid and HEXA_8 connectivity.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  do boundary (QUAD) elements (this part is optional,</span>
<span class="c">!  but you must do it if you eventually want to define BCs</span>
<span class="c">!  at element faces rather than at nodes):</span>
<span class="c">!  INFLOW:</span>
<span class="w">      </span><span class="n">ielem_no</span><span class="o">=</span><span class="mi">0</span>
<span class="c">!  index no of first element</span>
<span class="w">      </span><span class="n">nelem_start</span><span class="o">=</span><span class="n">nelem_end</span><span class="o">+</span><span class="mi">1</span>
<span class="w">      </span><span class="n">i</span><span class="o">=</span><span class="mi">1</span>
<span class="w">      </span><span class="k">do </span><span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nk</span><span class="o">-</span><span class="mi">1</span>
<span class="w">        </span><span class="k">do </span><span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nj</span><span class="o">-</span><span class="mi">1</span>
<span class="w">          </span><span class="n">ielem_no</span><span class="o">=</span><span class="n">ielem_no</span><span class="o">+</span><span class="mi">1</span>
<span class="w">          </span><span class="n">ifirstnode</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="p">(</span><span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ni</span><span class="o">+</span><span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span>
<span class="w">          </span><span class="n">jelem</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span>
<span class="w">          </span><span class="n">jelem</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span>
<span class="w">          </span><span class="n">jelem</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span><span class="o">*</span><span class="n">nj</span><span class="o">+</span><span class="n">ni</span>
<span class="w">          </span><span class="n">jelem</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span><span class="n">ielem_no</span><span class="p">)</span><span class="o">=</span><span class="n">ifirstnode</span><span class="o">+</span><span class="n">ni</span>
<span class="w">        </span><span class="k">enddo</span>
<span class="k">      enddo</span>
<span class="c">!  index no of last element</span>
<span class="w">      </span><span class="n">nelem_end</span><span class="o">=</span><span class="n">nelem_start</span><span class="o">+</span><span class="n">ielem_no</span><span class="o">-</span><span class="mi">1</span>
<span class="c">!  write QUAD element connectivity for inflow face (user can give any name)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_section_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;InflowElem&#39;</span><span class="p">,</span><span class="n">QUAD_4</span><span class="p">,</span><span class="n">nelem_start</span><span class="p">,</span><span class="n">nelem_end</span><span class="p">,</span><span class="n">nbdyelem</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">  </span><span class="n">jelem</span><span class="p">,</span><span class="n">index_section</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  OUTFLOW:</span>
<span class="w">      </span><span class="p">...</span><span class="w"> </span><span class="n">etc</span><span class="p">...</span>
</pre></div>
</div>
<p>In this example, the jelem array must be dimensioned exactly as (4,N), where N is greater than or equal to the total number of elements. Note that the nelem_start and nelem_end range is defined subsequent to the range of any other elements (i.e., the HEXA_8 elements) already defined in this zone. In other words, all elements in a given zone must have a different number.</p>
<p>The layout of the CGNS file in this case is exactly the same as that shown in the previous figure, except that there are now three additional Elements_t nodes under Zone_t. These are shown separately below.</p>
<figure class="align-center" id="id15">
<a class="reference internal image-reference" href="../_images/tree_cartesianUelem.gif"><img alt="Diagram showing CGNS layout of Elements_t boundary face nodes" src="../_images/tree_cartesianUelem.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of additional `Elements_t` boundary face nodes.</em></span><a class="headerlink" href="#id15" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="single-zone-unstructured-grid-and-flow-solution">
<h3>Single-Zone Unstructured Grid and Flow Solution<a class="headerlink" href="#single-zone-unstructured-grid-and-flow-solution" title="Link to this heading">#</a></h3>
<p>The procedure for adding a flow solution to an unstructured zone is identical to that of a structured zone. However, the Rind field for unstructured grids indicates additional points rather than planes. An example of Rind capability for unstructured grids is not covered here. Considering the vertex and cell-center examples shown previously, the only difference for unstructured zones is that all arrays are one-dimensional (there is only one index), as opposed to three indices for 3-D structured arrays. A vertex solution indicates that the solution is stored at vertices or nodes. In the above example, there would be lists of 3213 data array items per solution variable. A cell center solution implies that the solution is stored at the center of each element. In the above example, there would be lists of 2560 data array items per solution variable.</p>
<p>The overall layout of the CGNS file is the same as shown previously, except that there would also be a FlowSolution_t node under Zone  1, and this node would have the children nodes GridLocation, Density, and Pressure.</p>
</section>
<section id="single-zone-unstructured-grid-with-boundary-conditions">
<h3>Single-Zone Unstructured Grid with Boundary Conditions<a class="headerlink" href="#single-zone-unstructured-grid-with-boundary-conditions" title="Link to this heading">#</a></h3>
<p>When writing boundary conditions to a CGNS file for an unstructured zone, one can follow the same general procedure outlined previously for a structured zone. In other words, the boundary conditions can be defined for point ranges or for individual points, where the points refer to nodes (vertices) of the grid. Coding would be essentially the same as that presented before, except that the points and/or ranges are now one-dimensional (there is only one index), as opposed to three indices for 3-D structured arrays.</p>
<p>However, for unstructured zones this is generally not the recommended method. Usually, for unstructured zones one has also already defined additional <cite>Elements_t</cite> nodes that <em>define</em> the boundary face elements. Therefore, it is best for the boundary conditions to be associated with these elements rather than with the nodes.</p>
<p>Because this concept is quite different from what was done with the structured zone earlier, we illustrate it with an example. We earlier showed how to create the additional Elements_t nodes defining the boundary faces. The face-center boundary conditions now can be written using the following code segment.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE BOUNDARY CONDITIONS TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!  we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!  we know that for the unstructured zone, the following face elements</span>
<span class="c">!  have been defined as inflow (real working code would check!):</span>
<span class="w">      </span><span class="n">nelem_start</span><span class="o">=</span><span class="mi">2561</span>
<span class="w">      </span><span class="n">nelem_end</span><span class="o">=</span><span class="mi">2688</span>
<span class="w">      </span><span class="n">icount</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="n">nelem_start</span><span class="p">,</span><span class="n">nelem_end</span>
<span class="w">        </span><span class="n">icount</span><span class="o">=</span><span class="n">icount</span><span class="o">+</span><span class="mi">1</span>
<span class="w">        </span><span class="n">ipnts</span><span class="p">(</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">n</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!  write boundary conditions for ilo face</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Ilo&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCTunnelInflow</span><span class="p">,</span><span class="n">PointList</span><span class="p">,</span><span class="n">icount</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  we know that for the unstructured zone, the following face elements</span>
<span class="c">!  have been defined as outflow (real working code would check!):</span>
<span class="w">      </span><span class="n">nelem_start</span><span class="o">=</span><span class="mi">2689</span>
<span class="w">      </span><span class="n">nelem_end</span><span class="o">=</span><span class="mi">2816</span>
<span class="w">      </span><span class="n">icount</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="n">nelem_start</span><span class="p">,</span><span class="n">nelem_end</span>
<span class="w">        </span><span class="n">icount</span><span class="o">=</span><span class="n">icount</span><span class="o">+</span><span class="mi">1</span>
<span class="w">        </span><span class="n">ipnts</span><span class="p">(</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">n</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!  write boundary conditions for ihi face</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Ihi&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCExtrapolate</span><span class="p">,</span><span class="n">PointList</span><span class="p">,</span><span class="n">icount</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  we know that for the unstructured zone, the following face elements</span>
<span class="c">!  have been defined as walls (real working code would check!):</span>
<span class="w">      </span><span class="n">nelem_start</span><span class="o">=</span><span class="mi">2817</span>
<span class="w">      </span><span class="n">nelem_end</span><span class="o">=</span><span class="mi">3776</span>
<span class="w">      </span><span class="n">icount</span><span class="o">=</span><span class="mi">0</span>
<span class="w">      </span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="n">nelem_start</span><span class="p">,</span><span class="n">nelem_end</span>
<span class="w">        </span><span class="n">icount</span><span class="o">=</span><span class="n">icount</span><span class="o">+</span><span class="mi">1</span>
<span class="w">        </span><span class="n">ipnts</span><span class="p">(</span><span class="n">icount</span><span class="p">)</span><span class="o">=</span><span class="n">n</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!  write boundary conditions for wall faces</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_boco_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;Walls&#39;</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w"> </span><span class="n">BCWallInviscid</span><span class="p">,</span><span class="n">PointList</span><span class="p">,</span><span class="n">icount</span><span class="p">,</span><span class="n">ipnts</span><span class="p">,</span><span class="n">index_bc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!  the above are all face-center locations for the BCs - must indicate this,</span>
<span class="c">!  otherwise Vertices will be assumed!</span>
<span class="w">      </span><span class="k">do </span><span class="n">ibc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">index_bc</span>
<span class="c">!  (the following call positions you in BC_t - it assumes there</span>
<span class="c">!  is only one Zone_t and one ZoneBC_t - real working code would check!)</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">     </span><span class="o">+</span><span class="w">    </span><span class="s1">&#39;ZoneBC_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;BC_t&#39;</span><span class="p">,</span><span class="n">ibc</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_gridlocation_write_f</span><span class="p">(</span><span class="n">FaceCenter</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">      </span><span class="k">enddo</span>
<span class="c">!  close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Note that we assume here that we know in advance the element numbers associated with each of the boundaries. We have written these element numbers as a PointList, but because they are in order, we could just as easily have used PointRange instead. In that case, only two ipnts values would be needed, equal to nelem_start and nelem_end, and icount would be 2. Finally, note that the GridLocation_t node under BC_t must be written using the API call cg_goto_f (which positions you correctly in the tree) followed by cg_gridlocation_write_f.</p>
<p>Note that the use of ElementList and ElementRange (recommended in previous versions of CGNS) has been deprecated and should not be used in new code. These are still accepted but will be internally replaced with the appropriate values of PointList/PointRange and GridLocation_t.</p>
<p>Below is a portion of the layout of the CGNS file for the ZoneBC_t node and its children. The ZoneBC_t node lies directly under Zone_t.</p>
<figure class="align-center" id="id16">
<a class="reference internal image-reference" href="../_images/tree_cartesian_UBC.gif"><img alt="Diagram showing CGNS layout for unstructured grid with boundary conditions at face centers" src="../_images/tree_cartesian_UBC.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of CGNS file for an unstructured zone with boundary conditions defined at face-center elements.</em></span><a class="headerlink" href="#id16" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The three figures, showing the general layout of a CGNS file for an unstructured grid, the layout of additional Elements_t boundary face nodes, and the layout at and below the ZoneBC_t node, taken together, constitute the entire layout of the file.</p>
</section>
</section>
<section id="additional-information">
<h2>Additional Information<a class="headerlink" href="#additional-information" title="Link to this heading">#</a></h2>
<p>This section introduces several additional types of data in CGNS. These items are by no means necessary to include when getting started, but it is likely that most users will eventually want to implement some of them into their CGNS files at some point in the future. The section ends with a discussion on the usage of links.</p>
<section id="convergence-history">
<h3>Convergence History<a class="headerlink" href="#convergence-history" title="Link to this heading">#</a></h3>
<p>The ConvergenceHistory_t node can be used to store data associated with the convergence of a CFD solution. For example, one may wish to store the global coefficient of lift as a function of iterations. In this case, this variable should be stored at the CGNSBase_t level of the CGNS file. This is achieved using the API in the following FORTRAN code segment:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE CONVERGENCE HISTORY INFORMATION TO EXISTING CGNS FILE</span>
<span class="w">     </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   go to base node</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   create history node (SIDS names it GlobalConvergenceHistory at base level)</span>
<span class="c">!   ntt is the number of recorded iterations</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_convergence_write_f</span><span class="p">(</span><span class="n">ntt</span><span class="p">,</span><span class="s1">&#39;&#39;</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   go to new history node</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ConvergenceHistory_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   write lift coefficient array (user must use SIDS-standard name here)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;CoefLift&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">ntt</span><span class="p">,</span><span class="n">cl</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the array cl must be declared as an array of size ntt or larger. Additional arrays of the same size may also be written under the ConvergenceHistory_t node. Note that the call to cg_convergence_write_f includes a blank string in this case, because we are not recording norm definitions.</p>
</section>
<section id="descriptor-nodes">
<h3>Descriptor Nodes<a class="headerlink" href="#descriptor-nodes" title="Link to this heading">#</a></h3>
<p>Descriptor nodes, which record character strings and can be inserted nearly everywhere in a CGNS file, have many possible uses. Users can insert comments or descriptions to help clarify the content of some data in the CGNS file. In the SIDS overview section, we mention a possible use for descriptor nodes to describe data that is UserDefinedData_t. Another potentially desirable use of the descriptor node is to maintain copies of the entire input file(s) from the CFD application code. Because descriptor nodes can include carriage returns, entire ASCII files can be “swallowed” into the CGNS file. In this way, a future user can see and retrieve the exact input file(s) used by the CFD code to generate the data contained in the CGNS file. The only ambiguity possible would be whether the CFD code itself has changed since that time; but if the CFD code has strict version control, then complete recoverability should be possible.</p>
<p>An example that writes a descriptor node at the CGNSBase_t level is given here:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!  WRITE DESCRIPTOR NODE AT BASE LEVEL</span>
<span class="w">     </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!  open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!  we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   go to base node</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   write descriptor node (user can give any name)</span>
<span class="w">     </span><span class="n">text1</span><span class="o">=</span><span class="s1">&#39;Supersonic vehicle with landing gear&#39;</span>
<span class="w">     </span><span class="n">text2</span><span class="o">=</span><span class="s1">&#39;M=4.6, Re=6 million&#39;</span>
<span class="w">     </span><span class="n">textstring</span><span class="o">=</span><span class="n">text1</span><span class="o">//</span><span class="nb">char</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span><span class="o">//</span><span class="n">text2</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_descriptor_write_f</span><span class="p">(</span><span class="s1">&#39;Information&#39;</span><span class="p">,</span><span class="n">textstring</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!  close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example, the Descriptor_t node is named Information and the character string textstring (which is made up of text1 and text2 with a line feed - char(10) - in-between) is written there. All character strings must be declared appropriately.</p>
</section>
<section id="dimensional-data">
<h3>Dimensional Data<a class="headerlink" href="#dimensional-data" title="Link to this heading">#</a></h3>
<p>The node DataClass_t denotes the class of the data. When data is dimensional, then DataClass_t = Dimensional. The DataClass_t node can appear at many levels in the CGNS hierarchy; precedence rules dictate that a DataClass_t lower in the hierarchy supersedes any higher up.</p>
<p>For dimensional data, one generally is expected to indicate the dimensionality of each particular variable through the use of DataClass_t, DimensionalUnits_t, and DimensionalExponents_t. An example of this is shown in the following code segment in which units are added to the structured grid and cell center flow solution used previously.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE DIMENSIONAL INFO FOR GRID AND FLOW SOLN</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">     </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one FlowSolution_t (real working code would check!)</span>
<span class="w">     </span><span class="n">index_flow</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one GridCoordinates_t (real working code would check!)</span>
<span class="w">     </span><span class="n">index_grid</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   put DataClass and DimensionalUnits under Base</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">Dimensional</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_units_write_f</span><span class="p">(</span><span class="n">Kilogram</span><span class="p">,</span><span class="n">Meter</span><span class="p">,</span><span class="nb">Second</span><span class="p">,</span><span class="n">Kelvin</span><span class="p">,</span><span class="n">Degree</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   read fields</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_nfields_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="n">nfields</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">do if</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">nfields</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_field_info_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">    </span><span class="n">index_flow</span><span class="p">,</span><span class="k">if</span><span class="p">,</span><span class="n">idatatype</span><span class="p">,</span><span class="n">fieldname</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">       </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">fieldname</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;Density&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">1.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=-</span><span class="mf">3.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">       </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">fieldname</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="s1">&#39;Pressure&#39;</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">1.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=-</span><span class="mf">1.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=-</span><span class="mf">2.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">         </span><span class="n">exponents</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">       </span><span class="k">else</span>
<span class="k">         write</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span><span class="s1">&#39;(&#39;&#39; Error! this fieldname not expected: &#39;&#39;,a32)&#39;</span><span class="p">)</span>
<span class="w">    </span><span class="o">+</span><span class="w">      </span><span class="n">fieldname</span>
<span class="w">         </span><span class="k">stop</span>
<span class="k">       end if</span>
<span class="c">!   write DimensionalExponents</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;FlowSolution_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="k">if</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_exponents_write_f</span><span class="p">(</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">exponents</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">enddo</span>
<span class="c">!   read grid</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_ncoords_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">ncoords</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mf">1.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="n">exponents</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mf">0.</span>
<span class="w">     </span><span class="k">do </span><span class="n">ic</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">ncoords</span>
<span class="c">!   write DimensionalExponents</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;GridCoordinates_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="n">ic</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">       </span><span class="k">call </span><span class="n">cg_exponents_write_f</span><span class="p">(</span><span class="n">RealSingle</span><span class="p">,</span><span class="n">exponents</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">enddo</span>
<span class="c">!   close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>Notice in this example that a DataClass_t node and a DimensionalUnits_t node are placed near the top of the hierarchy, under CGNSBase_t. DataClass_t is specified as Dimensional, and DimensionalUnits_t are specified as (Kilogram, Meter, Second, Kelvin, Degree). These specify that, by and large, the entire database is dimensional with MKS units (anything that is not dimensional or not MKS units could be superseded at lower levels). Then, for each variable locally, one need only specify the DimensionalExponents, where one exponent is defined for each unit.</p>
<p>The layout of part of the resulting CGNS file from the above example is shown below. The density has units of kilogram/meter3, and the pressure has units of kilogram/(meter-second2). The grid coordinates (not shown in the figure) have units of meters.</p>
<figure class="align-center" id="id17">
<a class="reference internal image-reference" href="../_images/tree_dimensional.gif"><img alt="Diagram showing CGNS layout for flow solution at cell centers with dimensional data" src="../_images/tree_dimensional.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of a CGNS file for flow solution at cell centers with dimensional data.</em></span><a class="headerlink" href="#id17" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="nondimensional-data">
<h3>Nondimensional Data<a class="headerlink" href="#nondimensional-data" title="Link to this heading">#</a></h3>
<p>This example is for the relatively common occurrence of CFD data that is purely nondimensional, for which the reference state is arbitrary (unknown). This type is referred to as NormalizedByUnknownDimensional. Another nondimensional type, NormalizedByDimensional, for which the data is nondimensional but the reference state is specifically known, is not covered here.</p>
<p>For a NormalizedByUnknownDimensional database, the DataClass is recorded as such, but also a ReferenceState is necessary to define the nondimensionalizations used. (A ReferenceState_t node can be used for any dataset to indicate the global reference state (such as free stream), as well as quantities such as the reference Mach number and Reynolds number. A ReferenceState_t node was not included in the previous section, but it could have been.)</p>
<p>For the current example, we do not go into detail regarding the choices of the items which should define the reference state for a NormalizedByUnknownDimensional database. We simply show in the example some typical choices which very often would likely be included. A detailed discussion of how the data in ReferenceState_t defines the nondimensionalizations is given in the SIDS document.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE NONDIMENSIONAL INFO</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   put DataClass under Base</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NormalizedByUnknownDimensional</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   put ReferenceState under Base</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_state_write_f</span><span class="p">(</span><span class="s1">&#39;ReferenceQuantities&#39;</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Go to ReferenceState node, write Mach array and its dataclass</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Mach&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xmach</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NondimensionalParameter</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Go to ReferenceState node, write Reynolds array and its dataclass</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">reue</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NondimensionalParameter</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Go to ReferenceState node to write reference quantities:</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;ReferenceState_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">  </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   First, write reference quantities that make up Mach and Reynolds:</span>
<span class="c">!   Mach_Velocity</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Mach_Velocity&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xmv</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Mach_VelocitySound</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Mach_VelocitySound&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xmc</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Reynolds_Velocity</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds_Velocity&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">rev</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Reynolds_Length</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds_Length&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">rel</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Reynolds_ViscosityKinematic</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Reynolds_ViscosityKinematic&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">renu</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!   Next, write flow field reference quantities:</span>
<span class="c">!   Density</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">rho0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Pressure</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">p0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocitySound</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocitySound&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">c0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   ViscosityMolecular</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;ViscosityMolecular&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vm0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   LengthReference</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;LengthReference&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">xlength0</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocityX</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocityX&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vx</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocityY</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocityY&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vy</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   VelocityZ</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;VelocityZ&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="n">vz</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>In this case, the only information added to the CGNS file is at the CGNSBase_t level. Note that Mach and Reynolds (which are stored under ReferenceState) are variables that are known as “NondimensionalParameter”s, so they must each contain a DataClass child node stating this (the local DataClass nodes supersede the overall NormalizedByUnknownDimensional data class that holds for everything else).</p>
<p>The layout of the relevant portion of the resulting CGNS file from the above example is shown below. Many of the reference quantities that appear under ReferenceState_t have been left out of the figure to conserve space.</p>
<figure class="align-center" id="id18">
<a class="reference internal image-reference" href="../_images/tree_nondimensional.gif"><img alt="Diagram showing CGNS layout for nondimensional data with arbitrary reference state" src="../_images/tree_nondimensional.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of a CGNS file with purely nondimensional data (reference state unknown).</em></span><a class="headerlink" href="#id18" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="flow-equation-sets">
<h3>Flow Equation Sets<a class="headerlink" href="#flow-equation-sets" title="Link to this heading">#</a></h3>
<p>The FlowEquationSet_t node is useful for describing how a flow solution was generated. This is one of the useful self-descriptive aspects of CGNS that may improve the usefulness and longevity of a CFD dataset. For example, under this node, information such as the following may be recorded: the flow field was obtained by solving the thin-layer Navier-Stokes equations (with diffusion only in the j-coordinate direction); the Spalart-Allmaras turbulence model was employed, and an ideal gas assumption was made with γ = 1.4.</p>
<p>The following FORTRAN code segment writes some of the above example flow equation set information under the Zone_t node from our earlier single-zone structured grid example. (Note that a FlowEquationSet_t node can also be placed at a higher level, under the CGNSBase_t node. The usual precedence rules apply).</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE FLOW EQUATION SET INFO</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">     </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">     </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   existing file must be 3D structured (real working code would check!)</span>
<span class="c">!   Create &#39;FlowEquationSet&#39; node under &#39;Zone_t&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="c">!   equation dimension = 3</span>
<span class="w">     </span><span class="n">ieq_dim</span><span class="o">=</span><span class="mi">3</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_equationset_write_f</span><span class="p">(</span><span class="n">ieq_dim</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!   Create &#39;GoverningEquations&#39; node under &#39;FlowEquationSet&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_governing_write_f</span><span class="p">(</span><span class="n">NSTurbulent</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Create &#39;DiffusionModel&#39; node under &#39;GoverningEquations&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;GoverningEquations_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">4</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="n">idata</span><span class="p">(</span><span class="mi">6</span><span class="p">)</span><span class="o">=</span><span class="mi">0</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_diffusion_write_f</span><span class="p">(</span><span class="n">idata</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!</span>
<span class="c">!   Create &#39;GasModel&#39; under &#39;FlowEquationSet&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_model_write_f</span><span class="p">(</span><span class="s1">&#39;GasModel_t&#39;</span><span class="p">,</span><span class="n">Ideal</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Create &#39;SpecificHeatRatio&#39; under GasModel</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;GasModel_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;SpecificHeatRatio&#39;</span><span class="p">,</span><span class="n">RealSingle</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="nb">gamma</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   Create &#39;DataClass&#39; under &#39;SpecificHeatRatio&#39;</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="s1">&#39;FlowEquationSet_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;GasModel_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;DataArray_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_dataclass_write_f</span><span class="p">(</span><span class="n">NondimensionalParameter</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">     </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>This particular example is specific to a 3-D structured zone. In an unstructured zone, the use of DiffusionModel is not valid. The layout of the relevant portion of the resulting CGNS file from the above example is shown below.</p>
<figure class="align-center" id="id19">
<a class="reference internal image-reference" href="../_images/tree_floweqn.gif"><img alt="Diagram showing CGNS layout for flow equation set information" src="../_images/tree_floweqn.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of a CGNS file with flow equation set information.</em></span><a class="headerlink" href="#id19" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="time-dependent-data">
<h3>Time-Dependent Data<a class="headerlink" href="#time-dependent-data" title="Link to this heading">#</a></h3>
<p>Time-dependent data (data with multiple flow solutions) can also be stored in a CGNS file. Different circumstances may produce data with multiple flow solutions; for example:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Non-moving grid</p></li>
<li><p>Rigidly-moving grid</p></li>
<li><p>Deforming or changing grid</p></li>
</ol>
</div></blockquote>
<p>Each of these may either be the result of a time-accurate run, or else may simply be multiple snapshots of a non-time-accurate run as it iterates toward convergence.</p>
<p>This section gives an example for type 1 only. Readers interested in the two other types should refer to the SIDS document. For a non-moving grid, the method for storing the multiple flow solutions is relatively simple: multiple FlowSolution_t nodes, each with a different name, are placed under each Zone_t node. However, there also needs to be a mechanism for associating each FlowSolution_t with a particular time and/or iteration. This is accomplished through the use of BaseIterativeData_t (under CGNSBase_t) and ZoneIterativeData_t (under each Zone_t). BaseIterativeData_t contains NumberOfSteps, the number of times and/or iterations stored, and their values. ZoneIterativeData_t contains FlowSolutionPointers as a character data array. FlowSolutionPointers is dimensioned to be of size NumberOfSteps, and contains the names of the FlowSolution_t nodes within the current zone that correspond with the respective times and/or iterations. Finally, a SimulationType_t node is placed under CGNSBase_t to designate what type of simulation (e.g., TimeAccurate, NonTimeAccurate) produced the data. (Note: the SimulationType_t node is not restricted for use with time-dependent data; any CGNS dataset can employ it!)</p>
<p>The following FORTRAN code segment writes some of the above information, using our earlier single-zone structured grid example. For the purposes of this example, it is assumed that there are 3 flow solutions from a time-accurate simulation, to be output as a function of time to the CGNS file. The variables r1 and p1 represent the density and pressure at time 1, r2 and p2 are at time 2, and r3 and p3 are at time 3.</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="c">!   WRITE FLOW SOLUTION TO EXISTING CGNS FILE</span>
<span class="w">      </span><span class="k">use </span><span class="n">cgns</span>
<span class="c">!   open CGNS file for modify</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_open_f</span><span class="p">(</span><span class="s1">&#39;grid.cgns&#39;</span><span class="p">,</span><span class="n">CG_MODE_MODIFY</span><span class="p">,</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">     </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">ier</span><span class="w"> </span><span class="p">.</span><span class="n">ne</span><span class="p">.</span><span class="w"> </span><span class="n">CG_OK</span><span class="p">)</span><span class="w"> </span><span class="k">call </span><span class="n">cg_error_exit_f</span>
<span class="c">!   we know there is only one base (real working code would check!)</span>
<span class="w">      </span><span class="n">index_base</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   we know there is only one zone (real working code would check!)</span>
<span class="w">      </span><span class="n">index_zone</span><span class="o">=</span><span class="mi">1</span>
<span class="c">!   set up the times corresponding to the 3 solutions to be</span>
<span class="c">!   stored:</span>
<span class="w">      </span><span class="nb">time</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">1</span><span class="mf">0.</span>
<span class="w">      </span><span class="nb">time</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">2</span><span class="mf">0.</span>
<span class="w">      </span><span class="nb">time</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">=</span><span class="mi">5</span><span class="mf">0.</span>
<span class="c">!   define 3 different solution names (user can give any names)</span>
<span class="w">      </span><span class="n">solname</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution1&#39;</span>
<span class="w">      </span><span class="n">solname</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution2&#39;</span>
<span class="w">      </span><span class="n">solname</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s1">&#39;FlowSolution3&#39;</span>
<span class="c">!   do loop for the 3 solutions:</span>
<span class="w">      </span><span class="k">do </span><span class="n">n</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span>
<span class="c">!   create flow solution node</span>
<span class="w">        </span><span class="k">call </span><span class="n">cg_sol_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">solname</span><span class="p">(</span><span class="n">n</span><span class="p">),</span>
<span class="w">    </span><span class="o">+</span><span class="w">     </span><span class="n">Vertex</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   write flow solution (user must use SIDS-standard names here)</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r1</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p1</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="k">else if</span><span class="w"> </span><span class="p">(</span><span class="n">n</span><span class="w"> </span><span class="p">.</span><span class="n">eq</span><span class="p">.</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="w"> </span><span class="k">then</span>
<span class="k">          call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r2</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p2</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="k">else</span>
<span class="k">          call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Density&#39;</span><span class="p">,</span><span class="n">r3</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">          </span><span class="k">call </span><span class="n">cg_field_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span><span class="n">index_flow</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">       </span><span class="n">RealDouble</span><span class="p">,</span><span class="s1">&#39;Pressure&#39;</span><span class="p">,</span><span class="n">p3</span><span class="p">,</span><span class="n">index_field</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="w">        </span><span class="k">end if</span>
<span class="k">      enddo</span>
<span class="c">!   create BaseIterativeData</span>
<span class="w">      </span><span class="n">nsteps</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_biter_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="s1">&#39;TimeIterValues&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">nsteps</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   go to BaseIterativeData level and write time values</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;BaseIterativeData_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;TimeValues&#39;</span><span class="p">,</span><span class="n">RealDouble</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="nb">time</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   create ZoneIterativeData</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_ziter_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">index_zone</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="s1">&#39;ZoneIterativeData&#39;</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   go to ZoneIterativeData level and give info telling which</span>
<span class="c">!   flow solution corresponds with which time (solname(1) corresponds</span>
<span class="c">!   with time(1), solname(2) with time(2), and solname(3) with time(3))</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_goto_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span><span class="n">ier</span><span class="p">,</span><span class="s1">&#39;Zone_t&#39;</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">index_zone</span><span class="p">,</span><span class="s1">&#39;ZoneIterativeData_t&#39;</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="s1">&#39;end&#39;</span><span class="p">)</span>
<span class="w">      </span><span class="n">idata</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span><span class="o">=</span><span class="mi">32</span>
<span class="w">      </span><span class="n">idata</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span><span class="o">=</span><span class="mi">3</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_array_write_f</span><span class="p">(</span><span class="s1">&#39;FlowSolutionPointers&#39;</span><span class="p">,</span><span class="kt">Character</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">idata</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">solname</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   add SimulationType</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_simulation_type_write_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">index_base</span><span class="p">,</span>
<span class="w">    </span><span class="o">+</span><span class="w">   </span><span class="n">TimeAccurate</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
<span class="c">!   close CGNS file</span>
<span class="w">      </span><span class="k">call </span><span class="n">cg_close_f</span><span class="p">(</span><span class="n">index_file</span><span class="p">,</span><span class="n">ier</span><span class="p">)</span>
</pre></div>
</div>
<p>As cautioned for earlier coding snippets, dimensions must be set appropriately for all variables. The variable time (which is an array dimensioned size 3 in this case) contains the time values stored under BaseIterativeData_t. The layout of the resulting CGNS file from the above example is shown below. Compare this figure with the layout of a CGNS file for a simple Cartesian structured grid with a single flow solution. To conserve space, the GridCoordinates_t, ZoneType_t, and all nodes underneath FlowSolution_t have been left off.</p>
<figure class="align-center" id="id20">
<a class="reference internal image-reference" href="../_images/tree_cartesian_soltime.gif"><img alt="Diagram showing CGNS layout for time-accurate flow solutions" src="../_images/tree_cartesian_soltime.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of CGNS file for simple Cartesian structured grid with multiple time-accurate flow solutions (non-moving grid coordinates)</em></span><a class="headerlink" href="#id20" title="Link to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="using-links">
<h3>Using Links<a class="headerlink" href="#using-links" title="Link to this heading">#</a></h3>
<p>A link associates one node to another within a CGNS tree, or even one node to another in a separate CGNS file altogether. This can be useful when there is repeated data; rather than write the same data multiple times, links can point to the data written only once.</p>
<p>One very important use of links that may be required by many users is to point to grid coordinates. This usage comes about in the following way. Suppose a user is planning to use a particular grid for multiple cases. There are several options for how to store the data. Among these are:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Keep a copy of the grid with each flow solution in separate CGNS files.</p></li>
<li><p>Keep just one CGNS file, with the grid and multiple FlowSolution_t nodes; each FlowSolution_t node corresponds with a different case.</p></li>
<li><p>Keep just one CGNS file, with multiple CGNSBase_t nodes. The grid and one flow solution would be stored under one base. Other bases would each contain a separate flow solution, plus a link to the grid coordinates in the first base.</p></li>
<li><p>Keep one CGNS file with the grid coordinates defined, and store the flow solution for each case in its own separate CGNS file, with a link to the grid coordinates.</p></li>
</ol>
</div></blockquote>
<p>Item 1 is conceptually the most direct, and is certainly the recommended method in general (this is the way all example CGNS files have been portrayed so far in this document). However, if the grid is very large, then this method causes a lot of storage space to be unnecessarily used to store the same grid points multiple times. Item 2 may or may not be a viable option. If the user is striving to have the CGNS file be completely self-descriptive, with ReferenceState and FlowEquationSet describing the relevant conditions, then this method cannot be used if the ReferenceState or FlowEquationSet is different between the cases (for example, different Mach numbers, Reynolds numbers, or angles of attack). Item 3 removes this restriction. It uses links to the grid coordinates within the same file. Item 4 is similar to item 3, except that the grid coordinates and each flow solution are stored in separate files altogether.</p>
<p>A sample layout showing the relevant portions of two separate CGNS files for an example of item 4 is shown below. Note that for multiple-zone grids, each zone in FILE 1 in this example would have a separate link to the appropriate zone’s grid coordinates in FILE 2.</p>
<figure class="align-center" id="id21">
<a class="reference internal image-reference" href="../_images/tree_link.gif"><img alt="Diagram showing two CGNS files with a link from one to the other" src="../_images/tree_link.gif" style="width: 168px;" />
</a>
<figcaption>
<p><span class="caption-text"><em>Layout of part of two CGNS files with a link from one to the grid coordinates of the other.</em></span><a class="headerlink" href="#id21" title="Link to this image">#</a></p>
</figcaption>
</figure>
<p>The CGNS API now has the capability to specify links and to query link information in a CGNS file. Previously this was only possible by use of the ADF core library software. However, when a CGNS file is open for writing and the link creation call is issued, the link information is merely recorded and the actual link creation is deferred until the file is written out upon closing it. Therefore, any attempt to go to a location in a linked file while the CGNS file is open for writing will fail. This problem does not exist when a CGNS file is open for modification as link creation is immediate.</p>
<p>Reading a linked CGNS file presents no difficulties for the API, because links are “transparent.” As long as any separate linked files keep their name unchanged, and maintain the same position (within the Unix-directory) relative to the parent file, opening the parent file will automatically access the linked ones.</p>
<span class="target" id="doctroubleshoot"></span></section>
</section>
<section id="troubleshooting">
<h2>Troubleshooting<a class="headerlink" href="#troubleshooting" title="Link to this heading">#</a></h2>
<section id="handling-errors">
<h3>Handling Errors<a class="headerlink" href="#handling-errors" title="Link to this heading">#</a></h3>
<p>The API has extensive checks for errors relating to invalid data input and SIDS Noncompliance.
However, it is not guaranteed that the API will catch all problems prior to reaching the core level. Even then, additional
errors can arise due to I/O or invalid input. The list of errors that can occur in the CGIO or database manager core
routines may be found in the <a class="reference internal" href="../standard/CGIO/CGNS_CGIO_errors.html#error-messages"><span class="std std-ref">CGIO User’s Guide</span></a>. If an error occurs, the message given by API or
core routine should be descriptive enough to point to the source of the error.</p>
</section>
<section id="known-problems">
<h3>Known Problems<a class="headerlink" href="#known-problems" title="Link to this heading">#</a></h3>
<p>One known problem that can occur, which is not so much a problem as it is a restriction, relates to links. If a user makes
a link from one CGNS file to another, then the linked file <em>must</em> have write permission if the user wishes to open the
linking file in <code class="docutils literal notranslate"><span class="pre">CG_MODE_MODIFY</span></code> or <code class="docutils literal notranslate"><span class="pre">CG_MODE_WRITE</span></code> mode. In other words, opening a CGNS file in
<code class="docutils literal notranslate"><span class="pre">CG_MODE_MODIFY</span></code> or <code class="docutils literal notranslate"><span class="pre">CG_MODE_WRITE</span></code> mode implies that the entire CGNS hierarchy, including links (since they are
transparent), is accessible in that mode.</p>
</section>
</section>
<section id="example-computer-codes">
<h2>Example Computer Codes<a class="headerlink" href="#example-computer-codes" title="Link to this heading">#</a></h2>
<p>The following computer codes are complete, workable versions of the codes mentioned in the text of this User’s Guide (plus some that are not mentioned). They can be obtained from the CGNS site external link. They read and write very simple example CGNS files, in order to help the user understand the CGNS concepts as well as the usage of the API calls. Instructions for compiling them on LINUX systems is contained in comment lines in each program. The following codes are written in both FORTRAN and C. Note that these programs are very unsophisticated, purposefully for ease of readability. Real working codes would be written more generally, with more checks, and would not be as hardwired for particular cases. The codes are listed here by corresponding section.</p>
<section id="id1">
<h3>Structured Grid<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>Single-Zone Structured Grid:</dt><dd><ul class="simple">
<li><p>write_grid_str.f            writes grid</p></li>
<li><p>write_grid_str.c            writes grid (C-program example)</p></li>
<li><p>read_grid_str.f             reads grid</p></li>
</ul>
</dd>
<dt>Single-Zone Structured Grid and Flow Solution</dt><dd><ul class="simple">
<li><p>write_flowvert_str.f                writes vertex-based flow solution</p></li>
<li><p>read_flowvert_str.f         reads vertex-based flow solution</p></li>
<li><p>write_flowcent_str.f                writes cell centered flow solution</p></li>
<li><p>read_flowcent_str.f         reads cell centered flow solution</p></li>
<li><p>write_flowcentrind_str.f            writes cell centered flow solution with rind cells</p></li>
<li><p>read_flowcentrind_str.f             reads cell centered flow solution with rind cells</p></li>
</ul>
</dd>
<dt>Single-Zone Structured Grid with Boundary Conditions</dt><dd><ul class="simple">
<li><p>write_bc_str.f              writes PointRange boundary condition patches</p></li>
<li><p>read_bc_str.f               reads PointRange boundary condition patches</p></li>
<li><p>write_bcpnts_str.f          writes PointList boundary condition patches</p></li>
<li><p>read_bcpnts_str.f           reads PointList boundary condition patches</p></li>
</ul>
</dd>
<dt>Multi-Zone Structured Grid with 1-to-1 Connectivity</dt><dd><ul class="simple">
<li><p>write_grid2zn_str.f         writes 2-zone grid</p></li>
<li><p>read_grid2zn_str.f          reads 2-zone grid</p></li>
<li><p>write_con2zn_str.f          writes 1-to-1 connectivity for 2-zone example</p></li>
<li><p>read_con2zn_str.f           reads 1-to-1 connectivity for 2-zone example</p></li>
<li><p>write_con2zn_genrl_str.f            writes general 1-to-1 connectivity for 2-zone example</p></li>
<li><p>read_con2zn_genrl_str.f             reads general 1-to-1 connectivity for 2-zone example</p></li>
</ul>
</dd>
</dl>
</section>
<section id="id2">
<h3>Unstructured Grid<a class="headerlink" href="#id2" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>Single-Zone Unstructured Grid</dt><dd><ul class="simple">
<li><p>write_grid_unst.f             writes grid</p></li>
<li><p>read_grid_unst.f              reads grid</p></li>
</ul>
</dd>
<dt>Single-Zone Unstructured Grid and Flow Solution</dt><dd><ul class="simple">
<li><p>write_flowvert_unst.f         writes vertex-based flow solution</p></li>
<li><p>read_flowvert_unst.f          reads vertex-based flow solution</p></li>
</ul>
</dd>
<dt>Single-Zone Unstructured Grid with Boundary Conditions</dt><dd><ul class="simple">
<li><p>write_bcpnts_unst.f           writes PointList boundary condition patches (FaceCenter)</p></li>
<li><p>read_bcpnts_unst.f            reads PointList boundary condition patches (FaceCenter)</p></li>
</ul>
</dd>
</dl>
</section>
<section id="general">
<h3>General<a class="headerlink" href="#general" title="Link to this heading">#</a></h3>
<dl class="simple">
<dt>Convergence History</dt><dd><ul class="simple">
<li><p>write_convergence.f           writes convergence history</p></li>
<li><p>read_convergence.f            reads convergence history</p></li>
</ul>
</dd>
<dt>Descriptor Nodes</dt><dd><ul class="simple">
<li><p>write_descriptor.f            writes descriptor node under CGNSBase_t</p></li>
<li><p>read_descriptor.f             reads descriptor node under CGNSBase_t</p></li>
</ul>
</dd>
<dt>Dimensional Data</dt><dd><ul class="simple">
<li><p>write_dimensional.f           writes dimensional data to an existing grid + flow solution</p></li>
<li><p>read_dimensional.f            reads dimensional data from an existing grid + flow solution</p></li>
</ul>
</dd>
<dt>Nondimensional Data</dt><dd><ul class="simple">
<li><p>write_nondimensional.f                writes nondimensional data to an existing CGNS file</p></li>
<li><p>read_nondimensional.f         reads nondimensional data from an existing CGNS file</p></li>
</ul>
</dd>
<dt>Flow Equation Sets</dt><dd><ul class="simple">
<li><p>write_floweqn_str.f           writes flow equation information for structured example</p></li>
<li><p>read_floweqn_str.f            reads flow equation information for structured example</p></li>
</ul>
</dd>
<dt>Time-Dependent Data</dt><dd><ul class="simple">
<li><p>write_timevert_str.f          writes time-dependent flow soln (as Vertex) for structured example</p></li>
<li><p>read_timevert_str.f           reads time-dependent flow soln (as Vertex) for structured example</p></li>
</ul>
</dd>
</dl>
</section>
</section>
</section>


                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="papers.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Papers</p>
      </div>
    </a>
    <a class="right-next"
       href="../governance.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">CGNS Governance</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <dialog id="pst-secondary-sidebar-modal"></dialog>
                <div id="pst-secondary-sidebar" class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#structured-grid">Structured grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-structured-grid">Single-zone structured grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-structured-grid-and-flow-solution">Single-Zone Structured Grid and Flow Solution</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-flow-solution-at-vertices">(a) Flow Solution at Vertices</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b-flow-solution-at-cell-centers">(b) Flow Solution at Cell Centers</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#c-flow-solution-at-cell-centers-with-additional-rind-data">(c) Flow Solution at Cell Centers With Additional Rind Data</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-structured-grid-with-boundary-conditions">Single-Zone Structured Grid with Boundary Conditions</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-boundary-conditions-specifying-range">(a) Boundary Conditions Specifying Range</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b-boundary-conditions-specifying-points">(b) Boundary Conditions Specifying Points</a></li>
</ul>
</li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#multi-zone-structured-grid-with-1-to-1-connectivity">Multi-Zone Structured Grid with 1-to-1 Connectivity</a><ul class="nav section-nav flex-column">
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#a-connectivity-using-specific-1-to-1-method">(a) Connectivity Using Specific 1-to-1 Method</a></li>
<li class="toc-h4 nav-item toc-entry"><a class="reference internal nav-link" href="#b-connectivity-using-general-method">(b) Connectivity Using General Method</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#unstructured-grid">Unstructured Grid</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-unstructured-grid">Single-Zone Unstructured Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-unstructured-grid-and-flow-solution">Single-Zone Unstructured Grid and Flow Solution</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#single-zone-unstructured-grid-with-boundary-conditions">Single-Zone Unstructured Grid with Boundary Conditions</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#additional-information">Additional Information</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#convergence-history">Convergence History</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#descriptor-nodes">Descriptor Nodes</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#dimensional-data">Dimensional Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#nondimensional-data">Nondimensional Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#flow-equation-sets">Flow Equation Sets</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#time-dependent-data">Time-Dependent Data</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#using-links">Using Links</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#troubleshooting">Troubleshooting</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#handling-errors">Handling Errors</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#known-problems">Known Problems</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#example-computer-codes">Example Computer Codes</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Structured Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id2">Unstructured Grid</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#general">General</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  Dedicated to the public domain with <a href="https://creativecommons.org/publicdomain/zero/1.0/" class="reference external">CC0 1.0</a>.
</div>
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script defer src="../_static/scripts/bootstrap.js?digest=8878045cc6db502f8baf"></script>
<script defer src="../_static/scripts/pydata-sphinx-theme.js?digest=8878045cc6db502f8baf"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>